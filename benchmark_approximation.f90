! Benchmarking driver that measures and compares the execution time required for
! estimating a droplet's characteristics at some point in the future.  This also
! serves as a simple, manual tool for verifying that the Fortran implementations
! reproduce an expected value as a (very narrowly focused) sanity check.
!
! Currently this implements the following inference approaches:
!
!   1. RoseNNa executing its generated code from an ONNX model export
!   2. A naive, looped implementation using hard-coded weights and biases
!      derived from the ONNX model export
!
! Preliminary timings on Dr. Richter's Ivy Bridge and Epyc 7002 compute nodes
! result in the following observations:
!
!   1. RoseNNa is faster than the existing Gauss-Newton iterative approach on
!      both Ivy Bridge (3.8x) and Epyc nodes (0.3x).
!   2. Naive, looped implementation is significantly faster than RoseNNa on
!      both Ivy Bridge (25x) and Epyc nodes (20x) which results in it being
!      98x and 34x faster than Gauss-Newton on Ivy Bridge and Epyc nodes,
!      respectively.
!
! Initial analysis indicates that RoseNNa has several issues that prevent it
! from achieving high performance:
!
!   - The generated code does not respect Fortran's indexing order and writes
!     code with suboptimal strides, resulting in unnecessary transpositions
!     and strided memory access at run-time.
!   - RoseNNa does not generate fusable code so the matrix-vector
!     multiplications are not fused with either the bias additions or the
!     activation function resulted in most of its run-time waiting for data from
!     memory.
!   - RoseNNA's code does not vectorize with Intel ifort, even under maximum
!     optimization settings (-O3 -march=...) resulting in scalar execution.
!

module benchmarking

    integer :: measurement_id_hardcoded
    integer :: measurement_id_rosenna

end module benchmarking

module hardcoded_model

    use iso_c_binding, only:    C_FLOAT

    integer, parameter :: NUMBER_INPUTS  = 6
    integer, parameter :: NUMBER_OUTPUTS = 2

    integer, parameter :: NUMBER_HIDDEN_LAYER1_NEURONS = 32
    integer, parameter :: NUMBER_HIDDEN_LAYER2_NEURONS = 32
    integer, parameter :: NUMBER_HIDDEN_LAYER3_NEURONS = 32

    ! Weights for each of the layers after the input.
    real(C_FLOAT), dimension(NUMBER_INPUTS, NUMBER_HIDDEN_LAYER1_NEURONS)                :: layer1_weights
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER1_NEURONS, NUMBER_HIDDEN_LAYER2_NEURONS) :: layer2_weights
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER2_NEURONS, NUMBER_HIDDEN_LAYER3_NEURONS) :: layer3_weights
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER3_NEURONS, NUMBER_OUTPUTS)               :: output_weights

    ! Biases for each of the layers after the input.
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER1_NEURONS) :: layer1_biases
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER2_NEURONS) :: layer2_biases
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER3_NEURONS) :: layer3_biases
    real(C_FLOAT), dimension(NUMBER_OUTPUTS)               :: output_biases

    ! Arrays to hold the intermediate results between layers.
    !
    ! NOTE: We don't do anything fancy like detecting when we could reuse an
    !       intermediate.
    !
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER1_NEURONS) :: layer1_intermediate
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER2_NEURONS) :: layer2_intermediate
    real(C_FLOAT), dimension(NUMBER_HIDDEN_LAYER3_NEURONS) :: layer3_intermediate

end module hardcoded_model

subroutine setup_hardcoded_model()

    use hardcoded_model, only:  NUMBER_INPUTS, NUMBER_OUTPUTS, &
                                NUMBER_HIDDEN_LAYER1_NEURONS, &
                                NUMBER_HIDDEN_LAYER2_NEURONS, &
                                NUMBER_HIDDEN_LAYER3_NEURONS, &
                                layer1_weights, layer2_weights, layer3_weights, output_weights, &
                                layer1_biases, layer2_biases, layer3_biases, output_biases

    implicit none

    layer1_weights = transpose( &
                      reshape( [ &
                               -0.2179647535085678, &
                               -0.10499027371406555, &
                               0.28703930974006653, &
                               -0.007185535039752722, &
                               -0.17516379058361053, &
                               -0.2797003388404846, &
                               -0.3734329640865326, &
                               0.2745535969734192, &
                               0.17468850314617157, &
                               0.28758788108825684, &
                               -0.2674507200717926, &
                               -0.00384702836163342, &
                               -0.267046183347702, &
                               -0.04185278341174126, &
                               -0.30618816614151, &
                               0.029785657301545143, &
                               -0.1177220419049263, &
                               -0.37551942467689514, &
                               0.2098819464445114, &
                               0.19855280220508575, &
                               -0.12821775674819946, &
                               0.24359585344791412, &
                               -0.3235790729522705, &
                               0.24086403846740723, &
                               -0.20657087862491608, &
                               0.2711127996444702, &
                               -0.16499997675418854, &
                               0.08601540327072144, &
                               -0.11126592755317688, &
                               -0.11323869228363037, &
                               -0.382733553647995, &
                               -0.20243486762046814, &
                               0.31136050820350647, &
                               0.2857227921485901, &
                               -0.1486276239156723, &
                               -0.0879846140742302, &
                               0.052421990782022476, &
                               -0.33516567945480347, &
                               0.033615946769714355, &
                               0.3172573447227478, &
                               -0.1360125094652176, &
                               0.2178606539964676, &
                               0.37552714347839355, &
                               0.37509071826934814, &
                               0.06980028748512268, &
                               0.3526841700077057, &
                               -0.2006615400314331, &
                               -0.14314869046211243, &
                               0.1274402141571045, &
                               0.2475186586380005, &
                               -0.3419128656387329, &
                               -0.023677075281739235, &
                               -0.03595273941755295, &
                               0.21294903755187988, &
                               0.3049815893173218, &
                               0.3942754864692688, &
                               0.260516494512558, &
                               0.17264103889465332, &
                               -0.33099159598350525, &
                               0.028743745759129524, &
                               -0.1518770307302475, &
                               0.20848442614078522, &
                               -0.26890745759010315, &
                               0.3936147689819336, &
                               0.1504567265510559, &
                               -0.10270603746175766, &
                               -0.36612093448638916, &
                               -0.06830621510744095, &
                               0.2008945196866989, &
                               0.3186021149158478, &
                               0.1050616204738617, &
                               0.06126517057418823, &
                               -0.2993724048137665, &
                               -0.25547605752944946, &
                               0.33688604831695557, &
                               0.38524824380874634, &
                               -0.0559081993997097, &
                               -0.25968068838119507, &
                               -0.2361644059419632, &
                               -0.1015319973230362, &
                               0.31877726316452026, &
                               0.11683708429336548, &
                               -0.09517710655927658, &
                               0.31645122170448303, &
                               -0.2679036557674408, &
                               -0.32478758692741394, &
                               0.22220924496650696, &
                               -0.003961395472288132, &
                               -0.340610146522522, &
                               0.20111298561096191, &
                               -0.29363906383514404, &
                               -0.06001170352101326, &
                               -0.17345869541168213, &
                               -0.3125198483467102, &
                               0.4009750783443451, &
                               0.2295399010181427, &
                               0.24186457693576813, &
                               0.06813719123601913, &
                               -0.020817695185542107, &
                               -0.24358919262886047, &
                               -0.13281163573265076, &
                               -0.3258548974990845, &
                               -0.014100190252065659, &
                               -0.013490100391209126, &
                               -0.04608496278524399, &
                               0.036917366087436676, &
                               0.04818791151046753, &
                               0.17578259110450745, &
                               -0.17812177538871765, &
                               -0.054359957575798035, &
                               0.0896160751581192, &
                               -0.20956331491470337, &
                               -0.06381488591432571, &
                               0.31151914596557617, &
                               -0.21102109551429749, &
                               0.17831964790821075, &
                               0.33494094014167786, &
                               0.3791316747665405, &
                               -0.0788094773888588, &
                               0.3242771029472351, &
                               0.23847906291484833, &
                               0.020589299499988556, &
                               -0.1876615285873413, &
                               -0.08835453540086746, &
                               0.13598516583442688, &
                               -0.20128384232521057, &
                               -0.28751781582832336, &
                               -0.1789066195487976, &
                               0.2362067997455597, &
                               -0.24459460377693176, &
                               -0.309287428855896, &
                               -0.20558318495750427, &
                               -0.2899543344974518, &
                               -0.3030237555503845, &
                               0.19671134650707245, &
                               -0.2479982227087021, &
                               0.0852307453751564, &
                               -0.05950537323951721, &
                               -0.17784714698791504, &
                               0.30971744656562805, &
                               0.11409002542495728, &
                               -0.2500073313713074, &
                               -0.06004251167178154, &
                               0.37304791808128357, &
                               -0.10789476335048676, &
                               -0.2410745620727539, &
                               0.20379020273685455, &
                               0.07879292964935303, &
                               0.33640560507774353, &
                               0.05663664638996124, &
                               -0.16179803013801575, &
                               -0.33247390389442444, &
                               -0.3557429909706116, &
                               0.21089524030685425, &
                               -0.38229382038116455, &
                               0.02776135504245758, &
                               0.2553916573524475, &
                               -0.28799018263816833, &
                               -0.3853680491447449, &
                               0.3161190152168274, &
                               -0.18393659591674805, &
                               0.23784755170345306, &
                               0.401773065328598, &
                               -0.213419109582901, &
                               0.3924252986907959, &
                               0.31915992498397827, &
                               -0.012188015505671501, &
                               -0.32140886783599854, &
                               -0.0015614803414791822, &
                               -0.1254042237997055, &
                               0.2306879609823227, &
                               0.2874899208545685, &
                               0.07263718545436859, &
                               0.24194487929344177, &
                               0.2948875427246094, &
                               -0.3213564455509186, &
                               -0.30902570486068726, &
                               -0.16967566311359406, &
                               0.37608540058135986, &
                               -0.06152115762233734, &
                               -0.28966858983039856, &
                               0.36630719900131226, &
                               -0.196096733212471, &
                               0.3203717768192291, &
                               0.23119983077049255, &
                               0.013454767875373363, &
                               0.08475852757692337, &
                               -0.2692756652832031, &
                               0.14235186576843262, &
                               -0.07309358566999435, &
                               0.2440536618232727, &
                               0.15087531507015228 &
                               ], &
                              ![NUMBER_INPUTS, NUMBER_HIDDEN_LAYER1_NEURONS] )
                               [NUMBER_HIDDEN_LAYER1_NEURONS, NUMBER_INPUTS] ) &
                               )
    layer2_weights = transpose( &
                      reshape( [ &
                                0.09799966216087341, &
                                0.012571245431900024, &
                                -0.033344775438308716, &
                                -0.1375320702791214, &
                                -0.123392254114151, &
                                -0.09983284026384354, &
                                0.03031683899462223, &
                                0.14345496892929077, &
                                0.12146523594856262, &
                                0.017728818580508232, &
                                0.025589752942323685, &
                                0.10426892340183258, &
                                0.023672599345445633, &
                                0.1690874844789505, &
                                -0.10062511265277863, &
                                -0.02790903113782406, &
                                0.032615527510643005, &
                                -0.12874846160411835, &
                                0.03821085765957832, &
                                -0.031226325780153275, &
                                0.09755869954824448, &
                                -0.11802390217781067, &
                                0.024669161066412926, &
                                -0.025792352855205536, &
                                0.12149861454963684, &
                                0.15393558144569397, &
                                0.07688261568546295, &
                                -0.09072189033031464, &
                                0.12641121447086334, &
                                0.030963033437728882, &
                                0.16502532362937927, &
                                0.03589678555727005, &
                                0.042148806154727936, &
                                0.11627893894910812, &
                                0.010393939912319183, &
                                0.09151429682970047, &
                                -0.08885866403579712, &
                                -0.07434181123971939, &
                                -0.005817676894366741, &
                                -0.09099702537059784, &
                                0.013062930665910244, &
                                -0.15346795320510864, &
                                -0.14805525541305542, &
                                -0.06570646911859512, &
                                0.11085736006498337, &
                                0.14004087448120117, &
                                0.13509276509284973, &
                                -0.04585302993655205, &
                                -0.07108929753303528, &
                                -0.03831864893436432, &
                                0.017786433920264244, &
                                -0.02602744847536087, &
                                0.054016876965761185, &
                                0.030899539589881897, &
                                -0.14798738062381744, &
                                0.15042906999588013, &
                                -0.04515775665640831, &
                                -0.12436390668153763, &
                                -0.15686270594596863, &
                                0.15510337054729462, &
                                -0.07801547646522522, &
                                0.036635871976614, &
                                0.1764071136713028, &
                                0.16257120668888092, &
                                -0.07495418936014175, &
                                -0.10931659489870071, &
                                0.13666324317455292, &
                                -0.09104795753955841, &
                                0.04171615093946457, &
                                0.10671651363372803, &
                                0.17333203554153442, &
                                -0.08025039732456207, &
                                -0.11827033758163452, &
                                0.10342269390821457, &
                                0.09595728665590286, &
                                -0.14034421741962433, &
                                -0.028415173292160034, &
                                0.01739906147122383, &
                                0.08424103260040283, &
                                0.15295803546905518, &
                                0.14656458795070648, &
                                -0.02555028349161148, &
                                -0.032262906432151794, &
                                0.0997118130326271, &
                                0.11263857036828995, &
                                -0.11201842129230499, &
                                0.10686628520488739, &
                                -0.1648012101650238, &
                                -0.12471286207437515, &
                                0.00583306048065424, &
                                0.11069561541080475, &
                                0.16609984636306763, &
                                0.0671008825302124, &
                                0.09576256573200226, &
                                -0.11305512487888336, &
                                0.009188455529510975, &
                                0.15320584177970886, &
                                0.09192141145467758, &
                                -0.030436472967267036, &
                                -0.06404280662536621, &
                                0.05348717421293259, &
                                0.14884305000305176, &
                                -0.07444446533918381, &
                                -0.03633682057261467, &
                                -0.13317729532718658, &
                                -0.04675408825278282, &
                                -0.07763531804084778, &
                                -0.09655258804559708, &
                                -0.052251216024160385, &
                                -0.01791856437921524, &
                                0.16350966691970825, &
                                0.0344482846558094, &
                                -0.1677880734205246, &
                                0.08183975517749786, &
                                0.090243399143219, &
                                0.024172881618142128, &
                                0.12171149998903275, &
                                -0.037927739322185516, &
                                0.11217931658029556, &
                                -0.06299963593482971, &
                                0.08420253545045853, &
                                0.0967574492096901, &
                                -0.055592410266399384, &
                                0.10149025917053223, &
                                -0.12581591308116913, &
                                0.0386686809360981, &
                                0.16888844966888428, &
                                0.15875855088233948, &
                                -0.02134457603096962, &
                                -0.12987256050109863, &
                                -0.1153363436460495, &
                                -0.15445387363433838, &
                                -0.04783220589160919, &
                                -0.0602710023522377, &
                                -0.01032300665974617, &
                                0.024715732783079147, &
                                0.08460550010204315, &
                                -0.025343257933855057, &
                                -0.15201978385448456, &
                                -0.15083226561546326, &
                                0.09362667053937912, &
                                -0.0784802958369255, &
                                0.03970974683761597, &
                                0.05717257782816887, &
                                -0.1389414221048355, &
                                0.10648015141487122, &
                                -0.11676021665334702, &
                                0.1669202297925949, &
                                -0.03439861163496971, &
                                -0.11565261334180832, &
                                0.0559823103249073, &
                                0.03237845003604889, &
                                -0.17351777851581573, &
                                -0.04620295390486717, &
                                0.0036471353378146887, &
                                -0.16175656020641327, &
                                -0.12949298322200775, &
                                0.08373377472162247, &
                                0.15176744759082794, &
                                0.16565948724746704, &
                                -0.16431781649589539, &
                                -0.027353303506970406, &
                                -0.1627996414899826, &
                                -0.11872725188732147, &
                                -0.14272479712963104, &
                                0.06494653970003128, &
                                0.05875201150774956, &
                                -0.06329657882452011, &
                                0.16839125752449036, &
                                0.16495221853256226, &
                                -0.044257331639528275, &
                                0.07705467939376831, &
                                -0.03465598449110985, &
                                0.008100919425487518, &
                                -0.009904404170811176, &
                                -0.060496509075164795, &
                                0.028524650260806084, &
                                -0.0003561197954695672, &
                                -0.042562585324048996, &
                                -0.07740563899278641, &
                                -0.1737135499715805, &
                                -0.08201635628938675, &
                                0.17097002267837524, &
                                -0.06016877666115761, &
                                -0.1514054238796234, &
                                -0.12001688033342361, &
                                0.018569985404610634, &
                                0.03507949411869049, &
                                0.11168926954269409, &
                                -0.14398682117462158, &
                                -0.11993380635976791, &
                                0.021939752623438835, &
                                -0.13759222626686096, &
                                -0.053880445659160614, &
                                -0.12317473441362381, &
                                0.025110311806201935, &
                                -0.003928634338080883, &
                                -0.12461771070957184, &
                                -0.16018350422382355, &
                                0.14467738568782806, &
                                0.07582786679267883, &
                                -0.16909638047218323, &
                                0.12051216512918472, &
                                -0.060431331396102905, &
                                -0.023991629481315613, &
                                -0.12743006646633148, &
                                0.09565121680498123, &
                                -0.03865154832601547, &
                                0.10784847289323807, &
                                -0.047039758414030075, &
                                0.09593772888183594, &
                                -0.0009989013196900487, &
                                -0.13600099086761475, &
                                -0.05654166266322136, &
                                -0.03921319544315338, &
                                -0.1460912972688675, &
                                0.11057507991790771, &
                                0.1707777976989746, &
                                -0.030918357893824577, &
                                -0.16641764342784882, &
                                0.11117076128721237, &
                                0.17648351192474365, &
                                -0.14489449560642242, &
                                -0.120831198990345, &
                                -0.09772747755050659, &
                                -0.1486036330461502, &
                                -0.03344784304499626, &
                                -0.09490466862916946, &
                                -0.013662848621606827, &
                                -0.07435515522956848, &
                                -0.01798161491751671, &
                                -0.09548279643058777, &
                                0.09228598326444626, &
                                0.08457121253013611, &
                                -0.1377686858177185, &
                                -0.15268778800964355, &
                                -0.13952948153018951, &
                                0.010901576839387417, &
                                0.08156171441078186, &
                                -0.15733660757541656, &
                                -0.16341879963874817, &
                                -0.015933532267808914, &
                                -0.007251828908920288, &
                                -0.14430351555347443, &
                                -0.01563422568142414, &
                                -0.06158558651804924, &
                                0.011399858631193638, &
                                0.17409451305866241, &
                                -0.14085210859775543, &
                                0.06868144869804382, &
                                0.11882970482110977, &
                                0.020897040143609047, &
                                -0.15454980731010437, &
                                -0.09832371026277542, &
                                0.0033700407948344946, &
                                0.02354896068572998, &
                                -0.10842862725257874, &
                                0.10752126574516296, &
                                -0.13968738913536072, &
                                0.16707855463027954, &
                                0.176310196518898, &
                                -0.0373254157602787, &
                                0.06708595901727676, &
                                0.0514894537627697, &
                                -0.1086399257183075, &
                                -0.1412094682455063, &
                                0.0011922711273655295, &
                                0.036756835877895355, &
                                0.16682861745357513, &
                                -0.06729302555322647, &
                                0.03253159299492836, &
                                -0.08019097149372101, &
                                0.06691878288984299, &
                                -0.13635048270225525, &
                                0.08332760632038116, &
                                -0.00341939483769238, &
                                -0.06910725682973862, &
                                -0.07344982028007507, &
                                -0.15333177149295807, &
                                0.15391217172145844, &
                                -0.1640017032623291, &
                                0.075498066842556, &
                                -0.062054891139268875, &
                                0.06523977965116501, &
                                0.17317035794258118, &
                                -0.03791395574808121, &
                                0.17037460207939148, &
                                0.0982995331287384, &
                                0.1385936141014099, &
                                -0.028310732915997505, &
                                0.1578969955444336, &
                                0.14501693844795227, &
                                -0.040842317044734955, &
                                -0.12092912942171097, &
                                0.0959826409816742, &
                                0.114681676030159, &
                                -0.08916723728179932, &
                                0.15017299354076385, &
                                -0.1659570336341858, &
                                0.1545197069644928, &
                                -0.12161854654550552, &
                                -0.04592898115515709, &
                                -0.023888474330306053, &
                                0.10070614516735077, &
                                0.004324371926486492, &
                                -0.024286974221467972, &
                                -0.11756987869739532, &
                                0.05863187089562416, &
                                -0.05170760676264763, &
                                -0.13929274678230286, &
                                0.1283736526966095, &
                                0.008814697153866291, &
                                -0.027435006573796272, &
                                0.0005362132797017694, &
                                -0.12711124122142792, &
                                -0.12250695377588272, &
                                0.001720708329230547, &
                                -0.06778684258460999, &
                                0.006011278368532658, &
                                -0.01342358160763979, &
                                0.1714547872543335, &
                                0.058856260031461716, &
                                -0.0977291613817215, &
                                -0.05602957680821419, &
                                -0.06943077594041824, &
                                0.09054828435182571, &
                                0.10462086647748947, &
                                0.07947804033756256, &
                                0.08427662402391434, &
                                0.1455077975988388, &
                                -0.04951584339141846, &
                                -0.04439449682831764, &
                                0.14171643555164337, &
                                0.15459200739860535, &
                                0.022063642740249634, &
                                0.16262978315353394, &
                                -0.03695882484316826, &
                                0.05496694892644882, &
                                -0.17357294261455536, &
                                -0.11892805993556976, &
                                -0.11823767423629761, &
                                -0.15750350058078766, &
                                0.15550991892814636, &
                                -0.07480300217866898, &
                                -0.12930810451507568, &
                                -0.12977156043052673, &
                                -0.09789837896823883, &
                                -0.08159056305885315, &
                                0.056586336344480515, &
                                0.14934423565864563, &
                                -0.11010155826807022, &
                                0.16755376756191254, &
                                -0.016440346837043762, &
                                -0.08720912039279938, &
                                -0.04167608916759491, &
                                0.08589886128902435, &
                                -0.08603798598051071, &
                                -0.09130467474460602, &
                                0.05704369395971298, &
                                -0.03943537175655365, &
                                -0.10801541805267334, &
                                -0.1573602855205536, &
                                0.13907812535762787, &
                                -0.08190685510635376, &
                                0.020365146920084953, &
                                -0.07975542545318604, &
                                0.06266330182552338, &
                                -0.13847503066062927, &
                                -0.02255130372941494, &
                                -0.02772950753569603, &
                                0.022644110023975372, &
                                0.010730861686170101, &
                                0.03767529875040054, &
                                -0.07099379599094391, &
                                -0.14620982110500336, &
                                -0.09536132961511612, &
                                -0.15280461311340332, &
                                -0.15199846029281616, &
                                -0.07374484837055206, &
                                0.11331456154584885, &
                                -0.03908685967326164, &
                                -0.10278661549091339, &
                                0.1233358383178711, &
                                -0.1363763064146042, &
                                0.08916974812746048, &
                                0.05473589897155762, &
                                -0.11288364976644516, &
                                -0.06643704324960709, &
                                0.13255998492240906, &
                                0.13894157111644745, &
                                -0.06493143737316132, &
                                0.012239107862114906, &
                                -0.08599438518285751, &
                                -0.023352598771452904, &
                                -0.03027690388262272, &
                                0.14306259155273438, &
                                -0.05884574353694916, &
                                -0.0057172831147909164, &
                                -0.13596349954605103, &
                                0.09120748192071915, &
                                0.174246683716774, &
                                0.10290311276912689, &
                                -0.029281143099069595, &
                                0.17552727460861206, &
                                -0.08001323789358139, &
                                0.15081530809402466, &
                                -0.10793514549732208, &
                                0.05553620681166649, &
                                -0.10910691320896149, &
                                0.11026382446289062, &
                                -0.06471146643161774, &
                                0.14619264006614685, &
                                0.04882575199007988, &
                                -0.16999270021915436, &
                                0.13232514262199402, &
                                0.02179432474076748, &
                                0.12299520522356033, &
                                -0.01217462308704853, &
                                0.011607726104557514, &
                                -0.032797981053590775, &
                                -0.020537717267870903, &
                                -0.1511818766593933, &
                                -0.06386484205722809, &
                                0.041927408427000046, &
                                -0.03154849633574486, &
                                -0.15415836870670319, &
                                0.07816748321056366, &
                                0.15549270808696747, &
                                0.05541002005338669, &
                                -0.022746801376342773, &
                                -0.07462897896766663, &
                                -0.02015342190861702, &
                                0.10079235583543777, &
                                0.14877860248088837, &
                                0.01161278411746025, &
                                0.04910636693239212, &
                                -0.006857081316411495, &
                                -0.026675835251808167, &
                                -0.008410445414483547, &
                                -0.1696852147579193, &
                                -0.07776331901550293, &
                                0.14872358739376068, &
                                0.036272525787353516, &
                                0.10020708292722702, &
                                -0.07608641684055328, &
                                -0.05018966645002365, &
                                0.01581263355910778, &
                                -0.02487083338201046, &
                                0.03912167251110077, &
                                -0.09362997859716415, &
                                -0.16966643929481506, &
                                0.14314420521259308, &
                                -0.06695296615362167, &
                                0.1065773218870163, &
                                -0.10214461386203766, &
                                0.15238532423973083, &
                                -0.1029854416847229, &
                                0.13726021349430084, &
                                0.04119308665394783, &
                                0.013483619317412376, &
                                0.08774428069591522, &
                                -0.10068951547145844, &
                                0.1764707863330841, &
                                0.11112098395824432, &
                                0.14139796793460846, &
                                -0.10071684420108795, &
                                -0.050299521535634995, &
                                0.11075948923826218, &
                                0.06434517353773117, &
                                -0.12470820546150208, &
                                -0.1328962743282318, &
                                0.02457433007657528, &
                                -0.05714695155620575, &
                                0.050488509237766266, &
                                -0.04657388851046562, &
                                -0.14704760909080505, &
                                0.10781968384981155, &
                                0.1486077904701233, &
                                -0.02017192356288433, &
                                0.09208200871944427, &
                                -0.13823142647743225, &
                                0.1683473438024521, &
                                0.14567162096500397, &
                                -0.12162775546312332, &
                                0.1225152388215065, &
                                0.0258311927318573, &
                                0.0956454873085022, &
                                -0.09202117472887039, &
                                0.052042022347450256, &
                                -0.0851786732673645, &
                                0.13773874938488007, &
                                0.07676563411951065, &
                                -0.07663335651159286, &
                                0.1631757766008377, &
                                0.08500165492296219, &
                                0.09666137397289276, &
                                0.13520818948745728, &
                                -0.1419411152601242, &
                                0.12341465055942535, &
                                -0.05404793843626976, &
                                -0.0452798530459404, &
                                0.1617412120103836, &
                                -0.14013032615184784, &
                                0.08721476793289185, &
                                -0.11917053163051605, &
                                -0.14322219789028168, &
                                0.06688365340232849, &
                                0.142776221036911, &
                                -0.017431914806365967, &
                                -0.15230345726013184, &
                                -0.018585769459605217, &
                                0.07551349699497223, &
                                0.16808277368545532, &
                                0.06398454308509827, &
                                0.039156001061201096, &
                                -0.16430963575839996, &
                                0.09868823736906052, &
                                0.04104146361351013, &
                                -0.08959534764289856, &
                                -0.09588435292243958, &
                                0.017693836241960526, &
                                -0.126830592751503, &
                                -0.10309093445539474, &
                                0.06373486667871475, &
                                0.1687719076871872, &
                                -0.09819568693637848, &
                                0.06269065290689468, &
                                -0.13072675466537476, &
                                0.14799688756465912, &
                                -0.04896673560142517, &
                                0.1766946166753769, &
                                0.042440738528966904, &
                                -0.15353523194789886, &
                                0.04762532562017441, &
                                0.01446932926774025, &
                                0.16288864612579346, &
                                0.08633855730295181, &
                                0.14329887926578522, &
                                -0.14120417833328247, &
                                0.09801869094371796, &
                                0.1304134577512741, &
                                -0.08964505791664124, &
                                0.10115064680576324, &
                                0.08205171674489975, &
                                0.122757688164711, &
                                -0.060935892164707184, &
                                -0.00726329255849123, &
                                0.1099521666765213, &
                                -0.04238767549395561, &
                                0.0683320090174675, &
                                0.07716270536184311, &
                                0.016957363113760948, &
                                0.13610978424549103, &
                                0.01578426919877529, &
                                -0.13683581352233887, &
                                -0.12774886190891266, &
                                0.1015763059258461, &
                                -0.004389973357319832, &
                                -0.10995073616504669, &
                                0.05846692994236946, &
                                -0.035336632281541824, &
                                0.025745464488863945, &
                                0.13306505978107452, &
                                0.1655310094356537, &
                                -0.12713678181171417, &
                                -0.04038810357451439, &
                                -0.16780251264572144, &
                                -0.17647631466388702, &
                                -0.10279061645269394, &
                                -0.04829198494553566, &
                                -0.09548583626747131, &
                                0.053836528211832047, &
                                -0.0039641219191253185, &
                                -0.13413000106811523, &
                                0.04362333565950394, &
                                0.16371671855449677, &
                                -0.11805441975593567, &
                                0.09697380661964417, &
                                0.17373131215572357, &
                                0.08186610043048859, &
                                0.1487559676170349, &
                                0.03239448741078377, &
                                -0.06944664567708969, &
                                0.13974101841449738, &
                                -0.10331907868385315, &
                                -0.08407927304506302, &
                                -0.157154381275177, &
                                -0.17537379264831543, &
                                -0.03689328581094742, &
                                -0.16834968328475952, &
                                0.1465521603822708, &
                                -0.08613947778940201, &
                                -0.04706201329827309, &
                                -0.025519032031297684, &
                                0.05567457526922226, &
                                0.1077173724770546, &
                                -0.041289497166872025, &
                                -0.11604315042495728, &
                                0.16616588830947876, &
                                -0.011479832231998444, &
                                -0.1575241982936859, &
                                -0.14637166261672974, &
                                -0.0029015576001256704, &
                                -0.12755261361598969, &
                                0.014219271950423717, &
                                -0.16150349378585815, &
                                -0.07456624507904053, &
                                -0.020816370844841003, &
                                -0.06276310235261917, &
                                -0.04906991124153137, &
                                -0.06608783453702927, &
                                0.1364814043045044, &
                                -0.16659919917583466, &
                                0.1635233461856842, &
                                0.09768212586641312, &
                                -0.09501119703054428, &
                                -0.1702001541852951, &
                                -0.09550553560256958, &
                                0.012493147514760494, &
                                0.04110350087285042, &
                                -0.1378868669271469, &
                                0.0020957519300282, &
                                0.16470493376255035, &
                                0.038544662296772, &
                                0.07828399538993835, &
                                0.019098801538348198, &
                                -0.015506372787058353, &
                                0.15803934633731842, &
                                0.0011590804206207395, &
                                0.11759929358959198, &
                                0.0417482852935791, &
                                -0.11287049949169159, &
                                0.0960402563214302, &
                                0.028227156028151512, &
                                -0.13822171092033386, &
                                0.049065422266721725, &
                                -0.10557664930820465, &
                                0.027570592239499092, &
                                0.1468500941991806, &
                                0.03576033562421799, &
                                0.06914666295051575, &
                                0.10552531480789185, &
                                -0.009843080304563046, &
                                0.008028574287891388, &
                                -0.10247685760259628, &
                                -0.06297173351049423, &
                                -0.11902398616075516, &
                                0.042587704956531525, &
                                0.1342129111289978, &
                                -0.1270604431629181, &
                                -0.044954776763916016, &
                                -0.14529477059841156, &
                                -0.06299729645252228, &
                                0.1268036961555481, &
                                0.04259830340743065, &
                                -0.004533946979790926, &
                                0.16658231616020203, &
                                -0.11092498153448105, &
                                0.14500905573368073, &
                                -0.0968848168849945, &
                                -0.09209899604320526, &
                                0.0882749930024147, &
                                -0.01344402227550745, &
                                0.028047526255249977, &
                                -0.10760115832090378, &
                                -0.17340831458568573, &
                                -0.14028696715831757, &
                                -0.17527718842029572, &
                                -0.16484017670154572, &
                                -0.11510352790355682, &
                                -0.11536416411399841, &
                                -0.17295342683792114, &
                                -0.009697694331407547, &
                                -0.12212160974740982, &
                                -0.09619326889514923, &
                                0.06933242827653885, &
                                0.041247665882110596, &
                                -0.03533678129315376, &
                                -0.07517199963331223, &
                                0.11573486775159836, &
                                -0.045393526554107666, &
                                -0.08616156131029129, &
                                0.0822216123342514, &
                                0.04409824684262276, &
                                0.14601446688175201, &
                                -0.036246880888938904, &
                                -0.007009168155491352, &
                                -0.10157327353954315, &
                                0.005377158056944609, &
                                -0.08530979603528976, &
                                -0.06369895488023758, &
                                0.11383520066738129, &
                                0.15983933210372925, &
                                -0.0525083988904953, &
                                -0.060913003981113434, &
                                0.11145476996898651, &
                                0.05661027505993843, &
                                0.08115126937627792, &
                                0.04947483539581299, &
                                0.13146735727787018, &
                                -0.022600699216127396, &
                                -0.15579552948474884, &
                                -0.039634473621845245, &
                                -0.1445961445569992, &
                                -0.12105874717235565, &
                                0.022704780101776123, &
                                0.1680070459842682, &
                                -0.039593253284692764, &
                                0.01703689433634281, &
                                0.07583838701248169, &
                                -0.026317229494452477, &
                                0.04492561146616936, &
                                0.13565021753311157, &
                                -0.07369039207696915, &
                                -0.12386947870254517, &
                                0.03753185272216797, &
                                -0.05830097571015358, &
                                0.02805631421506405, &
                                0.054115477949380875, &
                                0.15545997023582458, &
                                -0.04745246097445488, &
                                0.04950077831745148, &
                                -0.07027976214885712, &
                                -0.03793917968869209, &
                                -0.14905978739261627, &
                                -0.15305063128471375, &
                                0.14428240060806274, &
                                0.16540469229221344, &
                                -0.11533980071544647, &
                                -0.00032545794965699315, &
                                -0.0521632581949234, &
                                -0.1746329516172409, &
                                0.17246223986148834, &
                                -0.055469613522291183, &
                                -0.007046089041978121, &
                                -0.12770164012908936, &
                                0.012959017418324947, &
                                -0.14492326974868774, &
                                0.04538872092962265, &
                                -0.12003030627965927, &
                                -0.10756132751703262, &
                                0.0032239388674497604, &
                                -0.014737003482878208, &
                                -0.035872213542461395, &
                                0.07871446758508682, &
                                -0.016036368906497955, &
                                -0.17301544547080994, &
                                0.02377895638346672, &
                                0.08190451562404633, &
                                -0.057849541306495667, &
                                0.07273395359516144, &
                                -0.048730187118053436, &
                                -0.03303695470094681, &
                                -0.17046213150024414, &
                                0.11607509851455688, &
                                -0.14936096966266632, &
                                -0.03630344197154045, &
                                -0.0825730711221695, &
                                -0.07954488694667816, &
                                -0.15650783479213715, &
                                0.055257510393857956, &
                                -0.0845940113067627, &
                                -0.06177998706698418, &
                                0.16336438059806824, &
                                -0.07399193197488785, &
                                0.05289705470204353, &
                                -0.0002114507369697094, &
                                0.01350524090230465, &
                                0.1516903191804886, &
                                0.10460413247346878, &
                                0.0643339604139328, &
                                -0.06898155808448792, &
                                0.13863305747509003, &
                                0.0782955214381218, &
                                0.08990500122308731, &
                                -0.07004020363092422, &
                                0.10016147792339325, &
                                -0.038353968411684036, &
                                0.17402660846710205, &
                                -0.12604175508022308, &
                                0.08989294618368149, &
                                0.16094852983951569, &
                                0.11384565383195877, &
                                0.05386438965797424, &
                                0.07862567901611328, &
                                0.08281511813402176, &
                                -0.042292654514312744, &
                                0.040644269436597824, &
                                -0.04225434362888336, &
                                -0.05073842033743858, &
                                -0.11830791085958481, &
                                0.08469343930482864, &
                                0.14988799393177032, &
                                -0.12084696441888809, &
                                -0.14102168381214142, &
                                0.09170903265476227, &
                                -0.137977734208107, &
                                0.030912669375538826, &
                                -0.015885232016444206, &
                                0.10913629084825516, &
                                0.10007958859205246, &
                                0.1271345317363739, &
                                0.036455295979976654, &
                                -0.08384352177381516, &
                                0.12508068978786469, &
                                0.1605335772037506, &
                                0.0030570372473448515, &
                                0.0728166475892067, &
                                0.04360993206501007, &
                                0.05754612758755684, &
                                -0.00948105938732624, &
                                0.011461371555924416, &
                                -0.1251457780599594, &
                                0.14240334928035736, &
                                -0.03545721620321274, &
                                0.06599081307649612, &
                                -0.019278453662991524, &
                                -0.061444394290447235, &
                                -0.012391194701194763, &
                                -0.10874994844198227, &
                                0.15545670688152313, &
                                0.11574841290712357, &
                                -0.054235320538282394, &
                                -0.11903510987758636, &
                                0.12028815597295761, &
                                -0.05528106912970543, &
                                -0.09570792317390442, &
                                0.1419915109872818, &
                                0.08346144109964371, &
                                0.13261999189853668, &
                                -0.04441308230161667, &
                                -0.03190134838223457, &
                                -0.060769643634557724, &
                                -0.17421336472034454, &
                                -0.05196000263094902, &
                                0.1682177484035492, &
                                0.1683318167924881, &
                                -0.11081070452928543, &
                                0.04809395596385002, &
                                0.037123218178749084, &
                                -0.06564576178789139, &
                                -0.16558218002319336, &
                                -0.021946264430880547, &
                                -0.06791511178016663, &
                                -0.018854308873414993, &
                                0.16536247730255127, &
                                -0.11188169568777084, &
                                -0.07220182567834854, &
                                0.10304592549800873, &
                                0.08471740037202835, &
                                -0.08064083009958267, &
                                -0.03396977111697197, &
                                -0.11752971261739731, &
                                0.13292117416858673, &
                                -0.12856413424015045, &
                                0.1689479500055313, &
                                -0.10148335248231888, &
                                0.06955142319202423, &
                                -0.1721627116203308, &
                                -0.12188341468572617, &
                                -0.15563823282718658, &
                                -0.13937829434871674, &
                                -0.0272163487970829, &
                                -0.06908298283815384, &
                                -0.17546963691711426, &
                                -0.0711415633559227, &
                                0.005682827904820442, &
                                -0.1151278018951416, &
                                -0.0728580579161644, &
                                -0.025950994342565536, &
                                -0.039518821984529495, &
                                -0.1465410441160202, &
                                0.030286408960819244, &
                                0.1254044473171234, &
                                -0.03785642609000206, &
                                -0.0847383663058281, &
                                0.0631004273891449, &
                                0.07799457758665085, &
                                -0.173793762922287, &
                                -0.020883342251181602, &
                                0.16324785351753235, &
                                0.09852965921163559, &
                                -0.0696551501750946, &
                                -0.1722719967365265, &
                                -0.07504235953092575, &
                                -0.15774662792682648, &
                                0.03710728511214256, &
                                -0.019711533561348915, &
                                0.1117125153541565, &
                                0.10004888474941254, &
                                -0.1336752325296402, &
                                0.11362718790769577, &
                                0.1385115534067154, &
                                0.059655386954545975, &
                                0.10019974410533905, &
                                0.105783611536026, &
                                0.026508765295147896, &
                                0.0177163016051054, &
                                0.0010484450031071901, &
                                -0.12839335203170776, &
                                -0.15790925920009613, &
                                -0.06447521597146988, &
                                0.08181580156087875, &
                                0.15507206320762634, &
                                -0.00801652017980814, &
                                -0.09964711964130402, &
                                0.08479052037000656, &
                                0.055448394268751144, &
                                -0.04531624913215637, &
                                0.11214913427829742, &
                                0.06895751506090164, &
                                0.08688880503177643, &
                                0.1752341240644455, &
                                -0.12626369297504425, &
                                0.017011016607284546, &
                                0.06848257780075073, &
                                0.1289762258529663, &
                                -0.10411158949136734, &
                                0.1348114311695099, &
                                -0.03761007636785507, &
                                -0.16879801452159882, &
                                -0.005768639035522938, &
                                -0.08173462003469467, &
                                0.01776205189526081, &
                                -0.15133404731750488, &
                                0.15652593970298767, &
                                -0.059182118624448776, &
                                -0.1418786644935608, &
                                -0.008053124882280827, &
                                0.025842128321528435, &
                                -0.0428461916744709, &
                                -0.15656131505966187, &
                                0.056278474628925323, &
                                0.11454779654741287, &
                                0.07276655733585358, &
                                -0.08327582478523254, &
                                0.06903843581676483, &
                                0.02835852839052677, &
                                -0.0604613795876503, &
                                0.15739236772060394, &
                                -0.07339401543140411, &
                                -0.15749859809875488, &
                                -0.14448848366737366, &
                                0.0033761311788111925, &
                                -0.0418395958840847, &
                                -0.1367960274219513, &
                                0.1603734940290451, &
                                -0.1354760229587555, &
                                -0.1630479097366333, &
                                -0.12324155867099762, &
                                -0.160831019282341, &
                                0.08082104474306107, &
                                -0.12527413666248322, &
                                -0.10658541321754456, &
                                -0.02527078613638878, &
                                -0.01224646158516407, &
                                0.1630529761314392, &
                                0.04698370397090912, &
                                0.13416370749473572, &
                                0.07623555511236191, &
                                0.08581680059432983, &
                                0.14083540439605713, &
                                -0.043318845331668854, &
                                0.09843229502439499, &
                                0.048408541828393936, &
                                0.05706259608268738, &
                                0.14764539897441864, &
                                -0.046032682061195374, &
                                -0.07915913313627243, &
                                0.15690982341766357, &
                                0.03576408699154854, &
                                0.1581825166940689, &
                                -0.026082176715135574, &
                                0.030000759288668633, &
                                0.1652543693780899, &
                                -0.16534672677516937, &
                                -0.06244002655148506, &
                                -0.0723763182759285, &
                                0.06745851784944534, &
                                0.033535826951265335, &
                                -0.10436954349279404, &
                                -0.04075975343585014, &
                                -0.1597815603017807, &
                                -0.030565716326236725, &
                                0.14448107779026031, &
                                -0.005557609722018242, &
                                0.06993148475885391, &
                                0.024195240810513496, &
                                -0.14380285143852234, &
                                -0.13481850922107697, &
                                0.08910804241895676, &
                                -0.03981832042336464, &
                                0.05356459692120552, &
                                0.1678430140018463, &
                                0.032584045082330704, &
                                -0.04490215703845024, &
                                0.06927776336669922, &
                                -0.15693338215351105, &
                                -0.004935648757964373, &
                                0.12713244557380676, &
                                -0.09191066026687622, &
                                -0.13705438375473022, &
                                0.15319515764713287, &
                                0.15685538947582245, &
                                0.07381008565425873, &
                                0.07325948029756546, &
                                0.13378332555294037, &
                                0.014804438687860966, &
                                0.16840723156929016, &
                                -0.1562667042016983, &
                                0.174983948469162, &
                                -0.13807377219200134, &
                                0.06891492009162903, &
                                0.1362169235944748, &
                                -0.027147142216563225, &
                                -0.08750994503498077, &
                                -0.007534339092671871, &
                                -0.049359649419784546, &
                                -0.11037757992744446, &
                                0.12099504470825195, &
                                -0.065113864839077, &
                                -0.009107786230742931, &
                                0.03902408108115196, &
                                0.0539611354470253 &
                                ], &
                                ![NUMBER_HIDDEN_LAYER1_NEURONS, NUMBER_HIDDEN_LAYER2_NEURONS] )
                                [NUMBER_HIDDEN_LAYER2_NEURONS, NUMBER_HIDDEN_LAYER1_NEURONS] ) &
                                )
    layer3_weights = transpose( &
                      reshape( [ &
                                 0.008650008589029312, &
                                -0.049204021692276, &
                                -0.13913150131702423, &
                                -0.1708410680294037, &
                                -0.1699649840593338, &
                                0.1393412947654724, &
                                -0.05368686467409134, &
                                -0.026955880224704742, &
                                -0.04458717256784439, &
                                -0.09653602540493011, &
                                0.02913685329258442, &
                                -0.15479983389377594, &
                                -0.05931618809700012, &
                                0.08034120500087738, &
                                -0.06984632462263107, &
                                0.07773229479789734, &
                                0.11473967134952545, &
                                -0.09902526438236237, &
                                -0.1585705429315567, &
                                0.021299773827195168, &
                                0.037265338003635406, &
                                0.1274300068616867, &
                                0.11451882123947144, &
                                0.12313307076692581, &
                                -0.10084908455610275, &
                                0.10656747967004776, &
                                0.015826372429728508, &
                                -0.09005095809698105, &
                                0.0584542416036129, &
                                -0.12422964721918106, &
                                0.048167355358600616, &
                                0.1627214103937149, &
                                0.12792113423347473, &
                                0.10381453484296799, &
                                -0.1405639499425888, &
                                0.1015673503279686, &
                                -0.15827393531799316, &
                                0.10239222645759583, &
                                0.05448175594210625, &
                                -0.0662069246172905, &
                                0.04481029510498047, &
                                0.0029264241456985474, &
                                0.11004868894815445, &
                                -0.042938850820064545, &
                                0.059507135301828384, &
                                0.0884900689125061, &
                                -0.1646835207939148, &
                                -0.14517667889595032, &
                                0.04277171567082405, &
                                0.06713522970676422, &
                                -0.053023938089609146, &
                                0.1127798855304718, &
                                -0.06309275329113007, &
                                -0.12391805648803711, &
                                -0.07327811419963837, &
                                -0.029653342440724373, &
                                0.01597382314503193, &
                                -0.15665893256664276, &
                                0.12418568879365921, &
                                0.1294964700937271, &
                                0.10214556008577347, &
                                -0.17471003532409668, &
                                -0.03370411694049835, &
                                -0.1336766928434372, &
                                -0.02612004615366459, &
                                -0.0825505405664444, &
                                0.11951573193073273, &
                                -0.05358649417757988, &
                                0.02442041039466858, &
                                0.12130884826183319, &
                                -0.13567620515823364, &
                                -0.015430382452905178, &
                                -0.038573238998651505, &
                                0.06284447014331818, &
                                0.11736506223678589, &
                                -0.03822426125407219, &
                                -0.004475636873394251, &
                                0.11883310228586197, &
                                -0.06665079295635223, &
                                0.11486642807722092, &
                                -0.09026487171649933, &
                                0.09461366385221481, &
                                -0.01256580837070942, &
                                0.1636383980512619, &
                                -0.0997907742857933, &
                                0.06724110245704651, &
                                -0.012987930327653885, &
                                0.16538245975971222, &
                                0.11828194558620453, &
                                -0.016701236367225647, &
                                -0.11352398991584778, &
                                -0.05931100249290466, &
                                -0.06908911466598511, &
                                -0.1631392389535904, &
                                0.053059171885252, &
                                0.00788084976375103, &
                                -0.0952838882803917, &
                                -0.04874521121382713, &
                                -0.0063795363530516624, &
                                0.08530646562576294, &
                                0.13489744067192078, &
                                0.09848544746637344, &
                                -0.1248922348022461, &
                                0.04512205719947815, &
                                -0.02994672581553459, &
                                -0.02239820547401905, &
                                0.03648589551448822, &
                                0.08049556612968445, &
                                0.13302449882030487, &
                                -0.08968621492385864, &
                                -0.06097237020730972, &
                                -0.11042288690805435, &
                                0.14338256418704987, &
                                0.14522869884967804, &
                                0.1424252688884735, &
                                -0.13595439493656158, &
                                0.07512490451335907, &
                                -0.17270322144031525, &
                                -0.10574778914451599, &
                                0.168901264667511, &
                                0.03962966799736023, &
                                0.004621465224772692, &
                                0.16948315501213074, &
                                -0.11528152972459793, &
                                -0.14493854343891144, &
                                -0.09570600837469101, &
                                0.08268406242132187, &
                                0.01983392797410488, &
                                -0.16016270220279694, &
                                -0.10225310176610947, &
                                -0.13990698754787445, &
                                -0.10342193394899368, &
                                0.041973959654569626, &
                                0.10396088659763336, &
                                0.13626214861869812, &
                                0.02362195961177349, &
                                0.07078994810581207, &
                                0.12139788269996643, &
                                -0.051959794014692307, &
                                0.13802127540111542, &
                                0.0023473475594073534, &
                                0.13991039991378784, &
                                -0.10047917813062668, &
                                0.022953657433390617, &
                                -0.14514963328838348, &
                                -0.08424870669841766, &
                                0.09193263947963715, &
                                0.06489522755146027, &
                                0.07290873676538467, &
                                -0.09894668310880661, &
                                -0.05736232176423073, &
                                -0.12137063592672348, &
                                0.006666240282356739, &
                                0.12421222031116486, &
                                0.14261804521083832, &
                                0.1303732842206955, &
                                0.05830826610326767, &
                                0.16872388124465942, &
                                -0.1716608703136444, &
                                -0.15125687420368195, &
                                -0.1702420711517334, &
                                0.05926453694701195, &
                                -0.10359427332878113, &
                                0.062112968415021896, &
                                0.0014898278750479221, &
                                0.10025318711996078, &
                                0.11225153505802155, &
                                0.03127439320087433, &
                                -0.08729642629623413, &
                                -0.027104806154966354, &
                                0.1434258222579956, &
                                0.15620926022529602, &
                                0.08596823364496231, &
                                0.0641045942902565, &
                                -0.1450493484735489, &
                                -0.10078556835651398, &
                                -0.13954921066761017, &
                                -0.14212530851364136, &
                                -0.03664398565888405, &
                                -0.15851223468780518, &
                                0.15287892520427704, &
                                -0.07545419782400131, &
                                -0.10636898875236511, &
                                0.12165388464927673, &
                                -0.13744501769542694, &
                                -0.13196930289268494, &
                                -0.013986705802381039, &
                                -0.1288301646709442, &
                                -0.17360015213489532, &
                                -0.14751820266246796, &
                                0.05289290472865105, &
                                0.152576744556427, &
                                0.046525988727808, &
                                -0.009716302156448364, &
                                -0.02459283359348774, &
                                -0.07647635787725449, &
                                0.05629225820302963, &
                                -0.05128141865134239, &
                                0.02358105592429638, &
                                0.0852433517575264, &
                                -0.04272305965423584, &
                                -0.10543309897184372, &
                                0.16638319194316864, &
                                0.03192446753382683, &
                                0.15563729405403137, &
                                -0.009806201793253422, &
                                -0.0040497430600225925, &
                                0.12562835216522217, &
                                0.09824668616056442, &
                                -0.14914032816886902, &
                                -0.0047014388255774975, &
                                0.00564706651493907, &
                                -0.09831474721431732, &
                                -0.08555974811315536, &
                                -0.059950392693281174, &
                                -0.05929762125015259, &
                                -0.016999782994389534, &
                                0.07942461967468262, &
                                -0.12905927002429962, &
                                0.14798413217067719, &
                                0.17274610698223114, &
                                -0.1679740846157074, &
                                0.16416190564632416, &
                                -0.14067713916301727, &
                                -0.041316576302051544, &
                                -0.08238330483436584, &
                                0.07469317317008972, &
                                -0.07760646939277649, &
                                -0.06637316942214966, &
                                -0.03234534710645676, &
                                -0.029717236757278442, &
                                -0.06825650483369827, &
                                -0.14857712388038635, &
                                -0.1756865382194519, &
                                -0.14209944009780884, &
                                -0.0037799400743097067, &
                                0.07577415555715561, &
                                -0.0636659562587738, &
                                -0.049836140125989914, &
                                -0.018586907535791397, &
                                -0.07635946571826935, &
                                0.12451588362455368, &
                                0.06318284571170807, &
                                -0.13404664397239685, &
                                -0.1453828364610672, &
                                0.010397606529295444, &
                                0.08376951515674591, &
                                0.15291443467140198, &
                                -0.12696398794651031, &
                                -0.07879089564085007, &
                                0.01967090368270874, &
                                0.13891494274139404, &
                                -0.05590355768799782, &
                                0.14016874134540558, &
                                0.07383493334054947, &
                                -0.14147824048995972, &
                                0.10454540699720383, &
                                -0.09541255980730057, &
                                -0.1413838118314743, &
                                -0.11834307760000229, &
                                -0.031625792384147644, &
                                -0.027924668043851852, &
                                -0.020267007872462273, &
                                -0.0036393171176314354, &
                                -0.0005634612170979381, &
                                -0.07611609250307083, &
                                0.08007662743330002, &
                                -0.10497148334980011, &
                                -0.07826478034257889, &
                                -0.022784817963838577, &
                                0.023823315277695656, &
                                0.06846639513969421, &
                                -0.019986141473054886, &
                                0.016488395631313324, &
                                0.03622365742921829, &
                                -0.0002473177155479789, &
                                -0.0563797764480114, &
                                -0.061347413808107376, &
                                0.10222169756889343, &
                                0.09757480025291443, &
                                -0.14758142828941345, &
                                0.15423144400119781, &
                                -0.14768736064434052, &
                                0.12739616632461548, &
                                -0.1383209228515625, &
                                -0.10588950663805008, &
                                0.13475562632083893, &
                                -0.1712689846754074, &
                                0.07565542310476303, &
                                -0.13046619296073914, &
                                0.06537220627069473, &
                                0.10455726832151413, &
                                -0.026209712028503418, &
                                0.0018924145260825753, &
                                -0.14422725141048431, &
                                0.0385567806661129, &
                                -0.0779736265540123, &
                                -0.011602774262428284, &
                                -0.12213410437107086, &
                                0.045262258499860764, &
                                0.01752506010234356, &
                                -0.12394838035106659, &
                                -0.011145438998937607, &
                                -0.036111630499362946, &
                                -0.1718343049287796, &
                                0.14105738699436188, &
                                0.10115953534841537, &
                                0.007501127198338509, &
                                0.03818110376596451, &
                                -0.04181799665093422, &
                                0.11474961787462234, &
                                0.16468371450901031, &
                                -0.05763522535562515, &
                                0.13794070482254028, &
                                0.07768325507640839, &
                                0.0796525701880455, &
                                0.10958600044250488, &
                                -0.011921762488782406, &
                                -0.07957767695188522, &
                                0.028863510116934776, &
                                -0.14110511541366577, &
                                -0.10641510039567947, &
                                -0.12129422277212143, &
                                0.02753746509552002, &
                                -0.047884151339530945, &
                                0.11727752536535263, &
                                -0.12064547836780548, &
                                -0.1291825920343399, &
                                0.03257894515991211, &
                                0.002376787131652236, &
                                0.05254457890987396, &
                                -0.09181174635887146, &
                                0.10573362559080124, &
                                -0.03204049915075302, &
                                -0.06336567550897598, &
                                0.04245220124721527, &
                                0.15641005337238312, &
                                0.07261208444833755, &
                                0.1651717722415924, &
                                0.15985776484012604, &
                                -0.14595282077789307, &
                                0.016552817076444626, &
                                -0.04974179342389107, &
                                0.15334931015968323, &
                                0.017680561169981956, &
                                -0.046016812324523926, &
                                -0.1501295119524002, &
                                -0.0015374537324532866, &
                                -0.11367866396903992, &
                                -0.08044811338186264, &
                                -0.04261096939444542, &
                                0.10388917475938797, &
                                -0.16609247028827667, &
                                -0.11404342949390411, &
                                -0.13719896972179413, &
                                -0.018262354657053947, &
                                -0.05066993087530136, &
                                -0.15072999894618988, &
                                0.10540429502725601, &
                                -0.15631256997585297, &
                                0.11061623692512512, &
                                0.16975919902324677, &
                                -0.17223279178142548, &
                                -0.009282127022743225, &
                                0.06105634570121765, &
                                -0.07670821249485016, &
                                0.11459989100694656, &
                                0.16114923357963562, &
                                -0.06922611594200134, &
                                0.11756469309329987, &
                                0.11985651403665543, &
                                0.13610051572322845, &
                                -0.06787827610969543, &
                                -0.08223439753055573, &
                                -0.0695408433675766, &
                                -0.0014663730980828404, &
                                0.029173120856285095, &
                                0.11035115271806717, &
                                -0.053619135171175, &
                                0.1745903491973877, &
                                0.12602150440216064, &
                                -0.002088502747938037, &
                                -0.06244021654129028, &
                                -0.013934969902038574, &
                                -0.11337306350469589, &
                                0.0498230941593647, &
                                -0.04917774349451065, &
                                0.16970184445381165, &
                                0.15076372027397156, &
                                0.045447684824466705, &
                                0.10922694951295853, &
                                0.019403081387281418, &
                                -0.006352794356644154, &
                                -0.026210028678178787, &
                                0.14827366173267365, &
                                0.03230680152773857, &
                                0.011005069129168987, &
                                -0.14338341355323792, &
                                -0.01256623025983572, &
                                0.17494642734527588, &
                                0.049328312277793884, &
                                0.0891578197479248, &
                                -0.08290953189134598, &
                                0.012018089182674885, &
                                -0.07411546260118484, &
                                0.030026109889149666, &
                                0.13801756501197815, &
                                -0.12091966718435287, &
                                0.1285826563835144, &
                                0.03261318802833557, &
                                0.12370894104242325, &
                                -0.09456858783960342, &
                                -0.12252610921859741, &
                                -0.10592310130596161, &
                                0.026161054149270058, &
                                0.033657945692539215, &
                                0.028191015124320984, &
                                -0.057165540754795074, &
                                -0.04658609256148338, &
                                0.13284477591514587, &
                                -0.04346007853746414, &
                                0.14225591719150543, &
                                -0.13372257351875305, &
                                0.1691940277814865, &
                                -0.0007193834753707051, &
                                -0.0832354947924614, &
                                0.11423268914222717, &
                                0.15003305673599243, &
                                0.1622924506664276, &
                                0.13807417452335358, &
                                -0.045158933848142624, &
                                -0.15831829607486725, &
                                -0.13432931900024414, &
                                -0.014407900162041187, &
                                0.014128213748335838, &
                                -0.11117421835660934, &
                                0.042061563581228256, &
                                0.16124197840690613, &
                                0.16209939122200012, &
                                -0.17236943542957306, &
                                0.10710801929235458, &
                                0.022372936829924583, &
                                0.17112158238887787, &
                                0.02411389723420143, &
                                -0.029800603166222572, &
                                0.05287758260965347, &
                                -0.020920030772686005, &
                                -0.030361345037817955, &
                                0.0510324165225029, &
                                0.13731072843074799, &
                                -0.013781324028968811, &
                                0.14415739476680756, &
                                -0.01862070895731449, &
                                0.06427644938230515, &
                                0.019549140706658363, &
                                -0.08371736109256744, &
                                0.16349756717681885, &
                                0.02164251171052456, &
                                0.018245307728648186, &
                                0.0018769677262753248, &
                                -0.10784267634153366, &
                                0.047104790806770325, &
                                -0.12387291342020035, &
                                -0.16875416040420532, &
                                0.11546223610639572, &
                                0.12886720895767212, &
                                0.06432466953992844, &
                                -0.031079823151230812, &
                                0.1453070491552353, &
                                -0.019935375079512596, &
                                -0.1305209845304489, &
                                -0.15859588980674744, &
                                -0.054729241877794266, &
                                0.10155399143695831, &
                                0.11946235597133636, &
                                0.05234815552830696, &
                                0.1104828417301178, &
                                -0.08383766561746597, &
                                -0.013669528998434544, &
                                0.16195939481258392, &
                                0.03789751976728439, &
                                -0.13445931673049927, &
                                -0.0821603462100029, &
                                0.11583390831947327, &
                                0.14560693502426147, &
                                0.09438390284776688, &
                                0.1545642763376236, &
                                0.10507569462060928, &
                                0.1258208155632019, &
                                -0.1062370091676712, &
                                -0.044571999460458755, &
                                -0.14931023120880127, &
                                -0.06341412663459778, &
                                0.1668732613325119, &
                                -0.14731846749782562, &
                                -0.10272059589624405, &
                                -0.11830776184797287, &
                                0.013610439375042915, &
                                -0.0653035044670105, &
                                0.07425933331251144, &
                                0.0785977840423584, &
                                0.12347345054149628, &
                                0.16421149671077728, &
                                -0.15853892266750336, &
                                -0.10519970953464508, &
                                -0.06780178099870682, &
                                0.05086793750524521, &
                                -0.07209561765193939, &
                                -0.1149701327085495, &
                                0.13310886919498444, &
                                -0.15590547025203705, &
                                -0.05752056464552879, &
                                0.04447202757000923, &
                                0.12066541612148285, &
                                0.16586145758628845, &
                                0.17277924716472626, &
                                0.1076168566942215, &
                                0.051856573671102524, &
                                -0.13892415165901184, &
                                0.16005311906337738, &
                                -0.16671092808246613, &
                                0.08527152240276337, &
                                0.10670176148414612, &
                                -0.1456766128540039, &
                                -0.12016689777374268, &
                                0.12349169701337814, &
                                0.11142058670520782, &
                                0.07488106191158295, &
                                -0.15230265259742737, &
                                -0.16144883632659912, &
                                0.05949575453996658, &
                                -0.11422958970069885, &
                                0.10354005545377731, &
                                0.046135351061820984, &
                                0.05519218370318413, &
                                -0.14498834311962128, &
                                -0.0783892571926117, &
                                0.06641513109207153, &
                                -0.04817289859056473, &
                                0.10124637931585312, &
                                0.043026622384786606, &
                                -0.11965864896774292, &
                                0.08421142399311066, &
                                -0.017230389639735222, &
                                0.10780113935470581, &
                                -0.062093980610370636, &
                                0.0910259559750557, &
                                0.12098423391580582, &
                                -0.11723398417234421, &
                                -0.11393226683139801, &
                                0.001566134742461145, &
                                0.07300563156604767, &
                                -0.04767455533146858, &
                                0.14938661456108093, &
                                0.15877531468868256, &
                                0.03605123236775398, &
                                0.017900904640555382, &
                                0.13023602962493896, &
                                0.09348851442337036, &
                                0.16499875485897064, &
                                0.13853292167186737, &
                                -0.053388383239507675, &
                                0.017487907782197, &
                                -0.1504015475511551, &
                                -0.07094994187355042, &
                                0.1500643789768219, &
                                -0.04204205051064491, &
                                0.044229891151189804, &
                                0.054243288934230804, &
                                -0.09015589952468872, &
                                -0.08080844581127167, &
                                0.06539039313793182, &
                                0.07762016355991364, &
                                0.13713552057743073, &
                                0.09226810932159424, &
                                -0.15924400091171265, &
                                -0.12067491561174393, &
                                0.007262639235705137, &
                                0.0328017957508564, &
                                0.036753229796886444, &
                                -0.10625875741243362, &
                                -0.12713433802127838, &
                                0.018185099586844444, &
                                -0.028578661382198334, &
                                0.17132727801799774, &
                                0.05280549079179764, &
                                0.0073654986917972565, &
                                -0.16764125227928162, &
                                0.08327589184045792, &
                                -0.14390623569488525, &
                                0.09092223644256592, &
                                -0.10594160109758377, &
                                0.13542179763317108, &
                                -0.07874640822410583, &
                                -0.12331805378198624, &
                                -0.1427474170923233, &
                                -0.02120978944003582, &
                                -0.13960835337638855, &
                                -0.027534745633602142, &
                                0.03181414678692818, &
                                -0.09390439838171005, &
                                -0.021984722465276718, &
                                0.009962502866983414, &
                                -0.097931407392025, &
                                0.14899593591690063, &
                                0.023315656930208206, &
                                -0.027590107172727585, &
                                0.1261940896511078, &
                                -0.1499159336090088, &
                                0.008692492730915546, &
                                0.10353786498308182, &
                                -0.13032153248786926, &
                                0.09473389387130737, &
                                0.0199069045484066, &
                                -0.10001680999994278, &
                                -0.05469914898276329, &
                                0.16921982169151306, &
                                0.11140885204076767, &
                                -0.10414880514144897, &
                                -0.11710324883460999, &
                                0.17631520330905914, &
                                0.11117101460695267, &
                                0.128269225358963, &
                                0.16980893909931183, &
                                0.06197359040379524, &
                                -0.0785222128033638, &
                                0.04817911610007286, &
                                0.03764819726347923, &
                                0.06167740374803543, &
                                0.15463414788246155, &
                                -0.14964166283607483, &
                                0.047806642949581146, &
                                -0.03303924947977066, &
                                0.014377827756106853, &
                                -0.04611939936876297, &
                                -0.14164839684963226, &
                                0.07075358182191849, &
                                0.17396117746829987, &
                                -0.16002362966537476, &
                                0.06708014011383057, &
                                -0.017363911494612694, &
                                -0.07233157753944397, &
                                0.0006461744196712971, &
                                -0.020038023591041565, &
                                0.0040618181228637695, &
                                -0.02499396540224552, &
                                0.05911343917250633, &
                                -0.16270491480827332, &
                                -0.09871027618646622, &
                                0.03766341507434845, &
                                -0.1516951471567154, &
                                -0.12038054317235947, &
                                0.015948325395584106, &
                                0.08742417395114899, &
                                -0.1696814000606537, &
                                0.07930772006511688, &
                                -0.10718563199043274, &
                                0.02186034806072712, &
                                -0.044870294630527496, &
                                -0.1503724455833435, &
                                0.10130070894956589, &
                                -0.09924139082431793, &
                                0.07160171866416931, &
                                0.08669537305831909, &
                                -0.009758302010595798, &
                                0.005044113844633102, &
                                -0.011344267055392265, &
                                0.08237763494253159, &
                                -0.09785722196102142, &
                                -0.1504543274641037, &
                                0.008162600919604301, &
                                -0.0297163724899292, &
                                0.11027077585458755, &
                                0.15659137070178986, &
                                0.038130149245262146, &
                                -0.033971622586250305, &
                                -0.04590192064642906, &
                                0.1691998839378357, &
                                -0.153608039021492, &
                                -0.12164926528930664, &
                                0.08955301344394684, &
                                -0.0844729021191597, &
                                -0.11410380154848099, &
                                -0.032323870807886124, &
                                -0.16478325426578522, &
                                0.03436959534883499, &
                                0.04635697975754738, &
                                0.17038460075855255, &
                                -0.06955163180828094, &
                                0.1763753741979599, &
                                -0.03858153894543648, &
                                -0.07507801055908203, &
                                -0.12515698373317719, &
                                0.015031209215521812, &
                                0.16526395082473755, &
                                -0.05164318531751633, &
                                -0.10612780600786209, &
                                0.06776037067174911, &
                                -0.15116514265537262, &
                                -0.00017653207760304213, &
                                0.062016770243644714, &
                                0.0971275195479393, &
                                -0.06784751266241074, &
                                0.10267122089862823, &
                                -0.030211808159947395, &
                                0.09688841551542282, &
                                0.046228792518377304, &
                                0.0045637451112270355, &
                                -0.026497449725866318, &
                                0.15577778220176697, &
                                0.034065697342157364, &
                                -0.011375918984413147, &
                                -0.07037491351366043, &
                                0.061768461018800735, &
                                -0.15096135437488556, &
                                -0.030955025926232338, &
                                0.008800935931503773, &
                                -0.01296205259859562, &
                                -0.1627821922302246, &
                                0.04665027931332588, &
                                -0.06242024153470993, &
                                -0.03235712647438049, &
                                0.15154120326042175, &
                                0.05796032398939133, &
                                -0.10603586584329605, &
                                0.045771077275276184, &
                                -0.1147543415427208, &
                                -0.07262371480464935, &
                                0.00630674883723259, &
                                -0.01667761243879795, &
                                -0.14497748017311096, &
                                -0.020449461415410042, &
                                -0.10505664348602295, &
                                0.13814286887645721, &
                                0.0022272502537816763, &
                                -0.13266819715499878, &
                                0.0060457754880189896, &
                                0.12289121001958847, &
                                0.02252211607992649, &
                                0.04430067911744118, &
                                0.01422475092113018, &
                                0.009230497293174267, &
                                -0.11229785531759262, &
                                0.041523199528455734, &
                                -0.11019668728113174, &
                                -0.0269052404910326, &
                                0.08679277449846268, &
                                0.16871899366378784, &
                                -0.011091005988419056, &
                                0.04862610250711441, &
                                0.043264053761959076, &
                                -0.14222005009651184, &
                                0.08570215851068497, &
                                -0.06478001922369003, &
                                0.11332638561725616, &
                                0.10856640338897705, &
                                -0.15260006487369537, &
                                0.05262663960456848, &
                                0.05209480971097946, &
                                -0.037898823618888855, &
                                -0.17283321917057037, &
                                -0.12362781167030334, &
                                -0.10501746833324432, &
                                -0.04531510919332504, &
                                0.16191700100898743, &
                                0.1649903953075409, &
                                -0.07935769110918045, &
                                0.04801621660590172, &
                                0.11234781891107559, &
                                0.049328796565532684, &
                                0.06793016195297241, &
                                0.022582722827792168, &
                                -0.11138290911912918, &
                                -0.03831165283918381, &
                                0.11424185335636139, &
                                -0.0707775205373764, &
                                -0.05387621000409126, &
                                0.09054160863161087, &
                                -0.04523735120892525, &
                                0.01143654715269804, &
                                -0.03339739516377449, &
                                0.03593653067946434, &
                                0.1657867282629013, &
                                0.16699540615081787, &
                                0.13824087381362915, &
                                0.012514874339103699, &
                                0.12423868477344513, &
                                0.08607311546802521, &
                                -0.0028568818233907223, &
                                0.07353398203849792, &
                                0.004105882719159126, &
                                -0.01466333121061325, &
                                -0.09185871481895447, &
                                -0.027566947042942047, &
                                0.17265361547470093, &
                                0.11412070691585541, &
                                0.05893046036362648, &
                                0.030697256326675415, &
                                -0.15771135687828064, &
                                0.1006808951497078, &
                                -0.045673612505197525, &
                                -0.0013525766553357244, &
                                -0.061771366745233536, &
                                0.127724289894104, &
                                -0.0063048736192286015, &
                                -0.17596958577632904, &
                                -0.027310946956276894, &
                                0.0547209158539772, &
                                0.04229550063610077, &
                                -0.11016924679279327, &
                                0.05445581302046776, &
                                -0.07542146742343903, &
                                -0.002338581020012498, &
                                -0.16650967299938202, &
                                -0.10692448914051056, &
                                0.16000129282474518, &
                                -0.14422990381717682, &
                                -0.041091933846473694, &
                                -0.025247015058994293, &
                                0.12159199267625809, &
                                0.027221089228987694, &
                                0.15406793355941772, &
                                -0.1508902609348297, &
                                -0.05379008129239082, &
                                0.11850473284721375, &
                                -0.03361162543296814, &
                                0.034674420952796936, &
                                0.14218305051326752, &
                                0.02247845195233822, &
                                0.11777038872241974, &
                                0.03649168834090233, &
                                0.04551731050014496, &
                                -0.10257550328969955, &
                                -0.0741392970085144, &
                                0.10026956349611282, &
                                -0.0036665438674390316, &
                                0.09943711757659912, &
                                0.17573685944080353, &
                                -0.06841615587472916, &
                                0.024997085332870483, &
                                0.0883212685585022, &
                                -0.12628845870494843, &
                                0.13970641791820526, &
                                -0.16127972304821014, &
                                0.1076061949133873, &
                                -0.10301408171653748, &
                                0.10627759993076324, &
                                -0.10414766520261765, &
                                0.13165952265262604, &
                                -0.06670714169740677, &
                                0.04515162482857704, &
                                0.14064133167266846, &
                                -0.11292744427919388, &
                                0.05061297118663788, &
                                -0.061978962272405624, &
                                -0.026264673098921776, &
                                -0.0640813335776329, &
                                -0.020540034398436546, &
                                0.1554308533668518, &
                                -0.10481356084346771, &
                                0.11511640250682831, &
                                -0.07864456623792648, &
                                -0.06126765161752701, &
                                -0.03475920110940933, &
                                -0.0973401665687561, &
                                0.02849946729838848, &
                                0.16664324700832367, &
                                0.13342872262001038, &
                                -0.08814964443445206, &
                                0.017735203728079796, &
                                -0.11183611303567886, &
                                0.06691733002662659, &
                                -0.024784749373793602, &
                                0.12426842004060745, &
                                -0.06905344128608704, &
                                0.05200400575995445, &
                                -0.10405153036117554, &
                                -0.168467715382576, &
                                0.11890586465597153, &
                                0.0623205192387104, &
                                0.006615474820137024, &
                                0.17319458723068237, &
                                0.08968954533338547, &
                                0.06012610346078873, &
                                -0.15637698769569397, &
                                -0.009670783765614033, &
                                -0.06971495598554611, &
                                -0.17475011944770813, &
                                0.018497196957468987, &
                                -0.04998769983649254, &
                                0.050648223608732224, &
                                -0.13503073155879974, &
                                0.10923649370670319, &
                                0.0920330360531807, &
                                0.09952400624752045, &
                                -0.08443296700716019, &
                                0.17571426928043365, &
                                0.17202427983283997, &
                                0.04689924046397209, &
                                0.046918757259845734, &
                                -0.12300726026296616, &
                                -0.009292200207710266, &
                                -0.09555687010288239, &
                                -0.1654120683670044, &
                                -0.031686801463365555, &
                                0.1742313802242279, &
                                0.05378340184688568, &
                                0.11999654024839401, &
                                0.07985881716012955, &
                                -0.018487313762307167, &
                                -0.08118719607591629, &
                                0.08464701473712921, &
                                -0.07617739588022232, &
                                0.12364664673805237, &
                                0.14351092278957367, &
                                0.08192967623472214, &
                                -0.16305284202098846, &
                                0.13610121607780457, &
                                0.07320521771907806, &
                                -0.04456691816449165, &
                                0.04638941213488579, &
                                0.033324796706438065, &
                                0.0828409343957901, &
                                0.06973301619291306, &
                                0.028506483882665634, &
                                0.004033179488033056, &
                                0.0477747805416584, &
                                0.03951439633965492, &
                                0.01800224557518959, &
                                -0.14634527266025543, &
                                -0.005874638445675373, &
                                -0.03730415552854538, &
                                0.11681527644395828, &
                                -0.1461799591779709, &
                                -0.10994995385408401, &
                                -0.14399191737174988, &
                                0.15741349756717682, &
                                0.0007884832448326051, &
                                0.04698001593351364, &
                                -0.045233916491270065, &
                                0.10950406640768051, &
                                0.07173248380422592, &
                                -0.026981927454471588, &
                                0.049528319388628006, &
                                0.12907885015010834, &
                                -0.10100778937339783, &
                                -0.17311720550060272, &
                                0.05008065328001976, &
                                -0.04606909677386284, &
                                0.09778104722499847, &
                                -0.09239151328802109, &
                                -0.003131257835775614, &
                                0.03104637935757637, &
                                -0.11421064287424088, &
                                0.17575480043888092, &
                                0.1653117835521698, &
                                -0.13873206079006195, &
                                0.11686498671770096, &
                                0.020867178216576576, &
                                -0.13631778955459595, &
                                -0.02677629329264164, &
                                -0.10240476578474045, &
                                0.0662255734205246, &
                                -0.004460042808204889, &
                                -0.02826005220413208, &
                                0.08313494920730591, &
                                0.028025588020682335, &
                                0.0015456724213436246, &
                                -0.07015837728977203, &
                                -0.11516238749027252, &
                                0.043864499777555466, &
                                0.12908193469047546, &
                                -0.13461901247501373, &
                                0.06706060469150543, &
                                0.048421964049339294, &
                                0.13161860406398773, &
                                0.05924301967024803, &
                                0.07205835729837418, &
                                -0.03329632431268692, &
                                -0.1251390427350998, &
                                -0.001321135088801384, &
                                -0.17100971937179565, &
                                -0.10548209398984909, &
                                -0.09359453618526459, &
                                0.07961126416921616, &
                                -0.10213637351989746, &
                                -0.00335208629257977, &
                                0.07949943095445633, &
                                -0.03367476165294647, &
                                -0.033488620072603226, &
                                0.10430135577917099, &
                                -0.16651734709739685, &
                                0.11796277016401291, &
                                -0.03502856194972992, &
                                -0.10314526408910751, &
                                -0.05150958150625229, &
                                -0.007949274964630604, &
                                -0.050963062793016434, &
                                0.028914296999573708, &
                                -0.04639701917767525, &
                                0.034914299845695496, &
                                0.13863663375377655, &
                                -0.025138845667243004, &
                                -0.06582867354154587, &
                                0.10961472243070602, &
                                -0.14494667947292328, &
                                -0.07294686138629913, &
                                -0.11679359525442123, &
                                -0.1671152263879776, &
                                -0.055563539266586304, &
                                0.07859832793474197, &
                                -0.08594372123479843, &
                                -0.10551218688488007, &
                                -0.10625835508108139, &
                                0.022302109748125076, &
                                -0.012803769670426846, &
                                0.08230070024728775, &
                                -0.07120227068662643, &
                                -0.16744652390480042, &
                                0.03402664512395859, &
                                -0.058902937918901443, &
                                0.08657872676849365, &
                                0.12233040481805801, &
                                -0.06573595106601715 &
                                ], &
                                ![NUMBER_HIDDEN_LAYER1_NEURONS, NUMBER_HIDDEN_LAYER2_NEURONS] )
                                [NUMBER_HIDDEN_LAYER3_NEURONS, NUMBER_HIDDEN_LAYER2_NEURONS] ) &
                               )
    output_weights = transpose( &
                      reshape( [ &
                                0.08290862292051315, &
                                -0.06513630598783493, &
                                0.09682827442884445, &
                                0.08464007824659348, &
                                0.016330154612660408, &
                                0.083551786839962, &
                                -0.039472293108701706, &
                                -0.06446073949337006, &
                                -0.07059264183044434, &
                                -0.09829510748386383, &
                                0.14709104597568512, &
                                0.1461702585220337, &
                                0.06288176774978638, &
                                -0.040153637528419495, &
                                -0.06854944676160812, &
                                -0.032456424087285995, &
                                -0.12995487451553345, &
                                -0.04599609971046448, &
                                -0.07875142991542816, &
                                -0.04757620394229889, &
                                -0.07112834602594376, &
                                -0.16128331422805786, &
                                -0.049540773034095764, &
                                0.10991638898849487, &
                                0.037976332008838654, &
                                -0.128922238945961, &
                                0.08975476771593094, &
                                -0.04935615137219429, &
                                -0.16326232254505157, &
                                -0.03265278413891792, &
                                0.01065396424382925, &
                                -0.17231132090091705, &
                                -0.022616799920797348, &
                                0.031287502497434616, &
                                0.17144308984279633, &
                                -0.03107137233018875, &
                                -0.03471840173006058, &
                                -0.02069595642387867, &
                                0.15319976210594177, &
                                0.15283313393592834, &
                                0.07316726446151733, &
                                0.04467732459306717, &
                                -0.1475275605916977, &
                                0.1447460800409317, &
                                -0.036955367773771286, &
                                -0.12248647212982178, &
                                -0.077704519033432, &
                                -0.04923287034034729, &
                                0.17421424388885498, &
                                -0.1269286423921585, &
                                0.052409205585718155, &
                                0.07080685347318649, &
                                0.13081654906272888, &
                                -0.14773021638393402, &
                                -0.025264210999011993, &
                                0.09957224130630493, &
                                0.026970569044351578, &
                                -0.17259949445724487, &
                                0.0519992858171463, &
                                0.11322628706693649, &
                                -0.11102057248353958, &
                                -0.016645539551973343, &
                                0.09186457842588425, &
                                0.15099236369132996 &
                                ], &
                                ![NUMBER_HIDDEN_LAYER2_NEURONS, NUMBER_OUTPUTS] )
                                [NUMBER_OUTPUTS, NUMBER_HIDDEN_LAYER2_NEURONS] ) &
                                )

    layer1_biases = [-0.07367875427007675, &
                     -0.022332601249217987, &
                     -0.21588146686553955, &
                     -0.38330042362213135, &
                     -0.11487122625112534, &
                     -0.1002083495259285, &
                     -0.27513664960861206, &
                     -0.040265414863824844, &
                     0.37094414234161377, &
                     -0.09905372560024261, &
                     0.0021576997824013233, &
                     -0.07942073047161102, &
                     0.22748610377311707, &
                     -0.24333937466144562, &
                     -0.09692785143852234, &
                     0.31718769669532776, &
                     0.35080966353416443, &
                     -0.06545291841030121, &
                     -0.37524083256721497, &
                     -0.3718242347240448, &
                     0.0860360860824585, &
                     0.009953323751688004, &
                     -0.034241072833538055, &
                     0.22888076305389404, &
                     0.07769616693258286, &
                     -0.35073184967041016, &
                     -0.24928094446659088, &
                     0.03656234219670296, &
                     0.22782516479492188, &
                     -0.29328373074531555, &
                     0.40521663427352905, &
                     0.01836380735039711 &
                     ]
    layer2_biases = [-0.013154642656445503, &
                     -0.15161310136318207, &
                     0.0017006674315780401, &
                     -0.0610741525888443, &
                     -0.14145320653915405, &
                     0.08412491530179977, &
                     -0.16194570064544678, &
                     0.15664072334766388, &
                     0.035531457513570786, &
                     0.11307455599308014, &
                     0.020907871425151825, &
                     -0.14155633747577667, &
                     0.1450452208518982, &
                     0.038409117609262466, &
                     0.09440021216869354, &
                     0.03882616013288498, &
                     -0.048335183411836624, &
                     -0.10047357529401779, &
                     -0.1111709326505661, &
                     -0.006054837256669998, &
                     -0.0366896316409111, &
                     -0.11782170087099075, &
                     -0.09121083468198776, &
                     -0.09551150351762772, &
                     -0.11926356703042984, &
                     -0.09071013331413269, &
                     0.07142027467489243, &
                     0.10865362733602524, &
                     -0.12475896626710892, &
                     -0.07995282113552094, &
                     0.17070136964321136, &
                     0.1425444334745407 &
                     ]
    layer3_biases = [-0.08643435686826706, &
                     -0.005375746171921492, &
                     0.00238281418569386, &
                     -0.12488032877445221, &
                     0.005796076729893684, &
                     -0.1114279180765152, &
                     0.08509258925914764, &
                     -0.028357895091176033, &
                     -0.14678092300891876, &
                     0.1613837629556656, &
                     0.09251157194375992, &
                     -0.1282808780670166, &
                     -0.13393066823482513, &
                     -0.04032587260007858, &
                     0.021731946617364883, &
                     0.1734268218278885, &
                     -0.12141072005033493, &
                     -0.069022037088871, &
                     -0.13448189198970795, &
                     0.048284925520420074, &
                     0.0764864981174469, &
                     -0.15610499680042267, &
                     -0.07790269702672958, &
                     -0.05084718018770218, &
                     0.05884043499827385, &
                     -0.05231435224413872, &
                     -0.09935112297534943, &
                     -0.09300839900970459, &
                     0.003510179230943322, &
                     0.14505356550216675, &
                     -0.12542971968650818, &
                     0.08750222623348236 &
                     ]
    output_biases = [0.08068914711475372, &
                     0.11238060891628265]

end subroutine setup_hardcoded_model

subroutine do_inference( input, output )

    use iso_c_binding, only:    C_FLOAT
    use hardcoded_model, only:  NUMBER_INPUTS, NUMBER_OUTPUTS, &
                                NUMBER_HIDDEN_LAYER1_NEURONS, &
                                NUMBER_HIDDEN_LAYER2_NEURONS, &
                                NUMBER_HIDDEN_LAYER3_NEURONS, &
                                layer1_weights, layer2_weights, layer3_weights, output_weights, &
                                layer1_biases, layer2_biases, layer3_biases, output_biases, &
                                layer1_intermediate, layer2_intermediate, layer3_intermediate

    implicit none


    !
    ! NOTE: This is hardcoded to assume a batch size of 1 so we can have a 1D
    !       array vs dealing with a 2D array with a singleton dimension.
    !
    real(C_FLOAT), dimension(NUMBER_INPUTS), intent(in)   :: input
    real(C_FLOAT), dimension(NUMBER_OUTPUTS), intent(out) :: output

    integer :: output_index

    do output_index = 1, NUMBER_HIDDEN_LAYER1_NEURONS
        layer1_intermediate(output_index) = &
             max( sum( input(:) * layer1_weights(:, output_index) ) + layer1_biases(output_index), 0.0 )
    end do

    !write(*,*) "Layer1:", layer1_intermediate

    do output_index = 1, NUMBER_HIDDEN_LAYER2_NEURONS
        layer2_intermediate(output_index) = &
             max( sum( layer1_intermediate(:) * layer2_weights(:, output_index) ) + layer2_biases(output_index), 0.0 )
    end do

    !write(*,*) "Layer2:", layer2_intermediate

    do output_index = 1, NUMBER_HIDDEN_LAYER3_NEURONS
        layer3_intermediate(output_index) = &
             max( sum( layer2_intermediate(:) * layer3_weights(:, output_index) ) + layer3_biases(output_index), 0.0 )
    end do

    !write(*,*) "Layer3:", layer3_intermediate

    do output_index = 1, NUMBER_OUTPUTS
        output(output_index) = sum( layer3_intermediate(:) * output_weights(:, output_index) ) + output_biases(output_index)
    end do

end subroutine do_inference

subroutine time_hardcoded( number_iterations )

    use iso_c_binding, only:    C_FLOAT

    use benchmarking, only:     measurement_id_hardcoded
    use measure, only:          REDUCTION_TYPE_MAX, &
                                end_phase, &
                                get_duration, &
                                start_phase

    implicit none

    integer, intent(in)            :: number_iterations

    real(C_FLOAT), dimension(1, 6) :: input
    real(C_FLOAT), dimension(1, 2) :: output

    real(C_FLOAT)                  :: dummy_sum
    real(C_FLOAT)                  :: duration
    integer                        :: iteration_index

    input     = 1.0
    dummy_sum = 0.0

    ! Initialize the weights and biases.
    call setup_hardcoded_model()

    do iteration_index = 1, number_iterations
        call start_phase( measurement_id_hardcoded )
        call do_inference( input, output )
        call end_phase( measurement_id_hardcoded )

        ! Ensure that the compiler keeps this loop by using the output.
        dummy_sum = dummy_sum + sum( output )
    end do

    duration = get_duration( measurement_id_hardcoded, REDUCTION_TYPE_MAX )

    write( *, "(I0,A,ES23.16,A,ES23.16,A)" ) number_iterations, " hardcoded iterations took ", duration, " seconds at ", &
         duration / number_iterations, " seconds per iteration."

    write( *, * ) output

end subroutine time_hardcoded

subroutine time_rosenna( number_iterations )

    use iso_c_binding, only:    C_FLOAT

    use benchmarking, only:     measurement_id_rosenna
    use measure, only:          REDUCTION_TYPE_MAX, &
                                end_phase, &
                                get_duration, &
                                start_phase
    use rosenna, only:          initialize, use_model

    implicit none

    integer, intent(in)            :: number_iterations

    real(C_FLOAT), dimension(1, 6) :: input
    real(C_FLOAT), dimension(1, 2) :: output

    real(C_FLOAT)                  :: dummy_sum
    real(C_FLOAT)                  :: duration
    integer                        :: iteration_index

    input     = 1.0
    dummy_sum = 0.0

    ! Setup RoseNNA.
    call initialize()

    do iteration_index = 1, number_iterations
        call start_phase( measurement_id_rosenna )
        call use_model( input, output )
        call end_phase( measurement_id_rosenna )

        ! Ensure that the compiler keeps this loop by using the output.
        dummy_sum = dummy_sum + sum( output )
    end do

    duration = get_duration( measurement_id_rosenna, REDUCTION_TYPE_MAX )

    write( *, "(I0,A,ES23.16,A,ES23.16,A)" ) number_iterations, " RoseNNa iterations took ", duration, " seconds at ", &
         duration / number_iterations, " seconds per iteration."

    write( *, * ) output

end subroutine time_rosenna

subroutine setup_measurements()

    use benchmarking, only:    measurement_id_hardcoded, measurement_id_rosenna
    use measure, only:         create_phase, initialize_measurements

    implicit none

    call initialize_measurements()

    measurement_id_hardcoded = create_phase( "hardcoded implementation times" )
    measurement_id_rosenna   = create_phase( "rosenna times" )

end subroutine setup_measurements

program benchmark_approximation

    implicit none

    integer, parameter :: NUMBER_HARDCODED_ITERATIONS = 10000000
    integer, parameter :: NUMBER_ROSENNA_ITERATIONS   = 100000

    call setup_measurements()

    call time_hardcoded( NUMBER_HARDCODED_ITERATIONS )
    call time_rosenna( NUMBER_ROSENNA_ITERATIONS )

end program benchmark_approximation
