module droplet_model

    ! Module containing a model of droplet size and temperature using a 4-layer
    ! multi-layer perceptron (MLP) neural network.  Once initialized, a single
    ! droplet's parameters and timestep can be used to estimate its future size
    ! and temperature.  This approach avoids an iterative search using
    ! Gauss-Newton to estimate its future charueacteristics and is typically much
    ! faster (O(30x) observed for small parameter count MLPs).
    !
    ! The module must be initialized with a call to initialize_model() and then
    ! droplet estimation, estimate(), can be performed as many times as
    ! necessary.  Weights for the MLP are hardcoded so initialization does not
    ! require any external resources.  An example calling sequence is the
    ! following:
    !
    !     ! Somewhere during simulation startup.
    !     call initialize_model()
    !
    !     ...
    !
    !     ! Particle simulation code.
    !     real*4 :: input_parameters(NUMBER_INPUTS)
    !     real*4 :: output_parameters(NUMBER_OUTPUTS)
    !
    !     do particle_index = 1, number_particles
    !
    !         input_parameters = [radius, temperature, salinity, air_temperature, rh, rhoa, t_final]
    !         call estimate( input_parameters, output_parameters )
    !
    !         new_radius      = output_parameters(RADIUS_INDEX)
    !         new_temperature = output_parameters(TEMPERATURE_INDEX)
    !
    !     end do
    !
    ! Inputs to the estimation, as are outputs, are provided in physical units
    ! and are internally normalized before using the model allowing this to be a
    ! drop-in replacement for alternative approaches for estimating droplet
    ! characteristics.
    !
    ! The model was trained on droplet parameters sampled from the product space
    ! of each of the individual parameters.  While this simple approach allowed
    ! for rapid development of a prototype it does include combinations of
    ! parameters that may be physically impossible which may have been
    ! under-sampled during training.  As a result the estimations in these
    ! corners of the parameter space may be of lower accuracy than more sampled,
    ! better behaved regions of the space.  The initial parameter ranges were
    ! selected by David Richter during prototyping and aim to cover all
    ! simulations of interest.
    !
    ! Things to note:
    !
    !   1. This approach was developed for code that would operate on a single
    !      droplet at a time vs multiple droplets at once.  As a result the
    !      application of a MLP network is simply a series of matrix-vector
    !      multiplications, vector-vector additions, and an activation function
    !      applied to the result.  We implement this case rather than attempt to
    !      generalize as the performance gain is already non-trivial and it is
    !      unclear when the code (if ever) would support batch estimation.
    !
    !   2. We could statically initialize each layer's weights and biases at
    !      compile time, albeit at the expense of readability.  By separating
    !      the weights and biases' definitions from their values we retain the
    !      ability to understand the structure and internal components of the
    !      MLP while requiring a single subroutine call at startup.
    !
    !   3. This is a naive implementation of a 4-layer MLP (it was written in 15
    !      minutes!)  and does not implement all potential optimizations.  In
    !      particular, each intermediate layer has its own array and no attempt
    !      to reuse arrays or work out of one large array has been made, so as
    !      to minimize the MLP's run-time footprint.  As initially developed the
    !      MLP is very small (O(2500) parameters) and uses O(10 KiB) storage,
    !      though should this ever be used for much larger MLPs, or with larger
    !      batch sizes (see above) then some of the omitted optimizations should
    !      be revisited.
    !
    !   4. While the MLP was trained on the product space of the input
    !      parameters and has poor performance on certain (likely) physically
    !      impossible parameter combinations, it is unclear what need to be done
    !      to improve the situation.  Re-training on a subset of the input
    !      parameters might improve performance and could be done without
    !      changing this implementation (albeit with undefined behavior for any
    !      physically impossible input) but it remains to be seen how much
    !      accuracy would be gained from this.
    !
    !   5. This approach is *NOT* OpenMP safe and is inherently single-threaded!
    !      Should multiple estimations need to be performed in parallel, an
    !      additional interface is needed that provides the intermediate layers
    !      to the estimation subroutine.  All of the weights and biases are
    !      effectively read-only and can be shared across threads.  This is
    !      straight forward to implement though it was not necessary for the
    !      initial implementation.
    !
    ! NOTE: This file was automatically generated from the the MLP's training
    !       code!  Do not modify this unless you really know what you're doing!
    !

    ! Indices into the input and output vectors.  The input vector uses all of
    ! the indices while the output vector only uses the first two.
    integer, parameter :: RADIUS_INDEX          = 1
    integer, parameter :: TEMPERATURE_INDEX     = 2
    integer, parameter :: SALINITY_INDEX        = 3
    integer, parameter :: AIR_TEMPERATURE_INDEX = 4
    integer, parameter :: RH_INDEX              = 5
    integer, parameter :: RHOA_INDEX            = 6
    integer, parameter :: TFINAL_INDEX          = 7

    integer, parameter :: NUMBER_INPUTS  = 7
    integer, parameter :: NUMBER_OUTPUTS = 2

    integer, parameter :: NUMBER_HIDDEN_LAYER1_NEURONS = 32
    integer, parameter :: NUMBER_HIDDEN_LAYER2_NEURONS = 32
    integer, parameter :: NUMBER_HIDDEN_LAYER3_NEURONS = 32

    ! The input variables must be normalized into the range of [-1, 1] before
    ! feeding them into the model.  The following ranges, means, and widths are
    ! used to map into, and from, the range of [-1, 1].
    !
    ! NOTE: These *must* match the training data!  Do not change these without
    !       retraining the model!
    !
    real*4, parameter :: RADIUS_LOG_RANGE(2)      = [-8.0, -3.0]
    real*4, parameter :: TEMPERATURE_RANGE(2)     = [273.0, 310.0]
    real*4, parameter :: SALINITY_LOG_RANGE(2)    = [-22.0, -10.0]
    real*4, parameter :: AIR_TEMPERATURE_RANGE(2) = [273.0, 310.0]
    real*4, parameter :: RH_RANGE(2)              = [0.65, 1.10]
    real*4, parameter :: RHOA_RANGE(2)            = [0.8, 1.2]

    real*4, parameter :: RADIUS_LOG_MEAN      = SUM( RADIUS_LOG_RANGE ) / 2
    real*4, parameter :: TEMPERATURE_MEAN     = SUM( TEMPERATURE_RANGE ) / 2
    real*4, parameter :: SALINITY_LOG_MEAN    = SUM( SALINITY_LOG_RANGE ) / 2
    real*4, parameter :: AIR_TEMPERATURE_MEAN = SUM( AIR_TEMPERATURE_RANGE ) / 2
    real*4, parameter :: RH_MEAN              = SUM( RH_RANGE ) / 2
    real*4, parameter :: RHOA_MEAN            = SUM( RHOA_RANGE ) / 2

    !
    ! NOTE: We have be careful about lines no longer than 132 characters so we
    !       eliminate whitespace in the expressions.
    !
    real*4, parameter :: RADIUS_LOG_WIDTH      = (RADIUS_LOG_RANGE(2)-RADIUS_LOG_RANGE(1))/2
    real*4, parameter :: TEMPERATURE_WIDTH     = (TEMPERATURE_RANGE(2)-TEMPERATURE_RANGE(1))/2
    real*4, parameter :: SALINITY_LOG_WIDTH    = (SALINITY_LOG_RANGE(2)-SALINITY_LOG_RANGE(1))/2
    real*4, parameter :: AIR_TEMPERATURE_WIDTH = (AIR_TEMPERATURE_RANGE(2)-AIR_TEMPERATURE_RANGE(1))/2
    real*4, parameter :: RH_WIDTH              = (RH_RANGE(2)-RH_RANGE(1))/2
    real*4, parameter :: RHOA_WIDTH            = (RHOA_RANGE(2)-RHOA_RANGE(1))/2

    ! Weights for each of the layers.
    real*4, dimension(NUMBER_INPUTS, NUMBER_HIDDEN_LAYER1_NEURONS)                :: layer1_weights
    real*4, dimension(NUMBER_HIDDEN_LAYER1_NEURONS, NUMBER_HIDDEN_LAYER2_NEURONS) :: layer2_weights
    real*4, dimension(NUMBER_HIDDEN_LAYER2_NEURONS, NUMBER_HIDDEN_LAYER3_NEURONS) :: layer3_weights
    real*4, dimension(NUMBER_HIDDEN_LAYER3_NEURONS, NUMBER_OUTPUTS)               :: output_weights

    ! Biases for each of the layers.
    real*4, dimension(NUMBER_HIDDEN_LAYER1_NEURONS) :: layer1_biases
    real*4, dimension(NUMBER_HIDDEN_LAYER2_NEURONS) :: layer2_biases
    real*4, dimension(NUMBER_HIDDEN_LAYER3_NEURONS) :: layer3_biases
    real*4, dimension(NUMBER_OUTPUTS)               :: output_biases

    ! Arrays to hold the intermediate results between layers.
    !
    ! NOTE: We don't do anything fancy like detecting when we could reuse an
    !       intermediate.
    !
    real*4, dimension(NUMBER_HIDDEN_LAYER1_NEURONS) :: layer1_intermediate
    real*4, dimension(NUMBER_HIDDEN_LAYER2_NEURONS) :: layer2_intermediate
    real*4, dimension(NUMBER_HIDDEN_LAYER3_NEURONS) :: layer3_intermediate

    contains

        subroutine initialize_model()

            implicit none

            layer1_weights = reshape( [-0.2826942801, &
                                       -0.0045786174, &
                                        0.3945737481, &
                                       -0.2011142224, &
                                       -0.0161087811, &
                                        0.0298185050, &
                                        0.4186864793, &
                                       -0.1177002117, &
                                        0.0089584617, &
                                       -0.2970601916, &
                                       -0.1269425601, &
                                        0.7430866957, &
                                        0.0104719000, &
                                        0.3303636611, &
                                       -0.4983414412, &
                                        0.0095770806, &
                                        0.0126334205, &
                                       -0.1575254500, &
                                       -0.0040968629, &
                                        0.0006055455, &
                                        0.2527055442, &
                                       -0.1195896268, &
                                       -0.0002580409, &
                                       -0.4756864011, &
                                        0.3115930557, &
                                       -0.0121982060, &
                                       -0.0297717527, &
                                       -1.4478129148, &
                                        0.9162972569, &
                                        0.0018099804, &
                                       -0.0519521609, &
                                       -0.1231669858, &
                                        0.0243698824, &
                                       -0.0094052637, &
                                       -0.0709574148, &
                                       -0.0992074013, &
                                        0.1434683651, &
                                       -0.1386247128, &
                                       -0.3274820149, &
                                       -0.0168732125, &
                                       -0.0341730379, &
                                        0.0956322700, &
                                       -0.3016887605, &
                                        0.0051655117, &
                                        0.6713389754, &
                                        0.2136879414, &
                                       -0.2089463323, &
                                       -0.0748234838, &
                                        0.4611063004, &
                                       -0.0480539761, &
                                        0.1420670599, &
                                       -0.1631674916, &
                                        0.2087012380, &
                                        0.0623452626, &
                                       -0.0616310686, &
                                        0.1077083945, &
                                        0.0325882696, &
                                       -0.1739832610, &
                                       -0.1021880731, &
                                       -0.1157527715, &
                                        0.0703979805, &
                                       -0.0205221660, &
                                        0.0333846584, &
                                        0.8416953683, &
                                        0.0994194746, &
                                       -0.0636881441, &
                                       -0.0369389504, &
                                        0.0065391790, &
                                       -0.0212366879, &
                                       -0.0082808882, &
                                       -0.5546349287, &
                                       -0.0477960333, &
                                       -0.1850980669, &
                                       -0.1574640274, &
                                        0.0395384803, &
                                        0.0201892741, &
                                        0.0859859511, &
                                       -0.5305081606, &
                                        0.0221088398, &
                                        0.3740321994, &
                                        0.0373550951, &
                                       -0.0163456388, &
                                       -0.0015851210, &
                                       -1.0322134495, &
                                        0.5115972757, &
                                       -0.0066214791, &
                                        0.1618083119, &
                                        0.0107275974, &
                                       -0.1270178556, &
                                        0.0093614003, &
                                       -0.0197385419, &
                                        0.0668166056, &
                                       -0.0030240272, &
                                       -0.0976212099, &
                                       -0.0352477096, &
                                       -0.0011556194, &
                                        0.0105509330, &
                                       -3.1388366222, &
                                        1.0406945944, &
                                       -0.0739319324, &
                                        0.0609789416, &
                                        0.0169177018, &
                                       -0.0034273497, &
                                       -0.0424064919, &
                                        0.2603797019, &
                                       -0.5158255696, &
                                        0.0591467842, &
                                        0.2564337552, &
                                       -0.2518966496, &
                                        0.0019628580, &
                                        0.0275993459, &
                                        0.2919778228, &
                                       -0.1290555298, &
                                        0.0264219325, &
                                        0.0133979376, &
                                        0.1360286474, &
                                        0.0062849196, &
                                       -0.0315689370, &
                                       -2.2970745564, &
                                       -0.3795559108, &
                                       -0.1731189787, &
                                        0.0614688471, &
                                        0.1846847385, &
                                       -0.2686977088, &
                                        0.0000997675, &
                                       -0.0200422537, &
                                        0.0148485741, &
                                        0.0284414217, &
                                        0.1268190145, &
                                        0.0157740414, &
                                        0.3719867766, &
                                       -0.0425331257, &
                                       -0.0220477972, &
                                       -0.0478279144, &
                                       -0.0049182293, &
                                        0.4415692389, &
                                        0.0205930490, &
                                       -0.0090383785, &
                                       -0.0208707843, &
                                       -1.6825181246, &
                                        0.6157743335, &
                                       -0.0021981269, &
                                       -0.5616130233, &
                                        0.0474067144, &
                                        0.0067198751, &
                                       -0.0072615794, &
                                        0.0345032029, &
                                       -0.0538545437, &
                                       -0.0207137987, &
                                       -0.4320527613, &
                                        0.3724974990, &
                                       -0.0179430097, &
                                        0.0056563499, &
                                        0.1101532504, &
                                       -0.0057910588, &
                                        0.0006959639, &
                                        0.3737111986, &
                                       -0.0665317550, &
                                       -0.0163642410, &
                                        0.0080785519, &
                                       -2.7747361660, &
                                        0.4736902416, &
                                       -0.1797742546, &
                                        0.0277410820, &
                                        0.0181014240, &
                                        0.0096456958, &
                                       -0.0002412051, &
                                       -1.4697972536, &
                                       -0.0393436551, &
                                        0.0297358464, &
                                        0.3393373191, &
                                        0.1837509274, &
                                        0.4078652859, &
                                       -0.0331864096, &
                                        0.1519615799, &
                                       -0.3184087873, &
                                       -0.0318396799, &
                                        0.1103257611, &
                                        0.1833458990, &
                                        0.0239469726, &
                                       -0.0118667800, &
                                        0.3638452888, &
                                       -0.4084412456, &
                                       -0.0830138549, &
                                        0.1650498807, &
                                        0.3252215981, &
                                        0.0598405041, &
                                       -0.0121297054, &
                                        0.2961293757, &
                                        0.8859914541, &
                                        0.0038836845, &
                                       -0.1807618141, &
                                        0.1594022065, &
                                        0.0941184983, &
                                       -0.0042423485, &
                                        0.2283404768, &
                                       -0.4019349813, &
                                       -0.0481689759, &
                                        0.3789058030, &
                                       -0.1587665528, &
                                        0.0140390936, &
                                        0.0240799692, &
                                       -1.2686690092, &
                                       -0.1140795425, &
                                        0.0083185602, &
                                       -0.5859520435, &
                                       -0.0274805985, &
                                       -0.4325812757, &
                                        0.0088365693, &
                                        0.0311477017, &
                                       -0.2872636914, &
                                        0.0517284423, &
                                       -0.3589392304, &
                                        0.2881166637, &
                                        0.2534032464, &
                                        0.0297127999, &
                                       -0.0107796984, &
                                        0.0061146487, &
                                        0.0015295936, &
                                       -0.4511249661, &
                                        0.0847238973, &
                                        0.0214775503, &
                                       -0.0084162476, &
                                        0.5710803866], &
                                       [7, 32] )
            layer2_weights = reshape( [-0.4064164758, &
                                       -0.0222391412, &
                                       -0.4256331325, &
                                        0.1811329126, &
                                       -0.0751024783, &
                                        0.1558189988, &
                                       -0.1670989394, &
                                        0.0030852105, &
                                        0.0510991700, &
                                        0.1782899201, &
                                        0.0364745446, &
                                        0.4736775458, &
                                       -0.1041926593, &
                                        0.9130803943, &
                                       -0.2570118606, &
                                       -0.1429408938, &
                                        0.3937593102, &
                                        0.0811299682, &
                                        0.0509412326, &
                                        0.2125019431, &
                                       -0.0943156779, &
                                        0.0007625372, &
                                       -0.9744671583, &
                                       -0.1628828943, &
                                       -0.0407332778, &
                                        0.0414090753, &
                                       -0.2040937692, &
                                       -0.1636968553, &
                                        0.4104442298, &
                                       -0.0328361727, &
                                       -0.0106210178, &
                                       -0.4804412425, &
                                       -0.0015146127, &
                                        0.0078496132, &
                                        0.2660485804, &
                                        0.2457436919, &
                                        0.1487165093, &
                                        0.1734515280, &
                                       -0.0658685640, &
                                        0.0476501435, &
                                        0.2990605831, &
                                       -0.1818831712, &
                                        0.2256041914, &
                                       -0.0670009553, &
                                        0.1782067865, &
                                        0.2740276456, &
                                        0.0799884796, &
                                       -0.1616565138, &
                                        0.2006528676, &
                                       -0.0340687856, &
                                       -0.0084265582, &
                                        0.0755427629, &
                                        0.1364339292, &
                                        0.0340680555, &
                                        0.2014971077, &
                                        0.3704673350, &
                                       -0.0377946906, &
                                       -0.1104398072, &
                                       -0.0249885023, &
                                        0.1187084839, &
                                        0.0085832933, &
                                       -0.1188586280, &
                                        0.0704290867, &
                                        0.1703604758, &
                                        0.0221663285, &
                                       -0.1862375885, &
                                        0.1934118867, &
                                       -0.2368267179, &
                                       -0.1841344982, &
                                       -0.0171900727, &
                                        0.0088936063, &
                                        0.0525059476, &
                                       -0.1496016234, &
                                       -0.2201858759, &
                                        0.1199076176, &
                                        0.2661183476, &
                                       -0.3847721517, &
                                       -0.7279321551, &
                                       -0.2041580677, &
                                        0.1890468001, &
                                       -0.0519482084, &
                                        0.1294593215, &
                                        0.0292099025, &
                                        0.5757326484, &
                                       -0.3478161097, &
                                        0.2075782716, &
                                       -0.0264060926, &
                                        0.0515935384, &
                                       -0.0197158139, &
                                       -0.0348569974, &
                                        0.2564509511, &
                                       -0.3460946083, &
                                        0.0563047938, &
                                        0.4623047709, &
                                        0.0824187845, &
                                        0.0000126405, &
                                        0.1121768132, &
                                       -0.1331986636, &
                                        0.0112012997, &
                                       -0.0002232742, &
                                       -0.1487663835, &
                                        0.1801538914, &
                                       -0.0240748078, &
                                       -0.0135737173, &
                                        0.1547006965, &
                                        0.1313179284, &
                                       -0.0523570739, &
                                       -0.1903575212, &
                                       -0.1436093897, &
                                       -0.8412305117, &
                                       -0.2071625143, &
                                        0.1847223639, &
                                       -0.1935415715, &
                                        0.0075341803, &
                                        0.1520213783, &
                                       -0.5891115069, &
                                       -0.1294551045, &
                                        0.1579128355, &
                                       -0.5651910901, &
                                       -0.4762004912, &
                                       -0.0982247293, &
                                        0.1131190807, &
                                        0.0065566562, &
                                       -0.3010222912, &
                                       -0.0676376522, &
                                        0.0493987165, &
                                       -0.0194971059, &
                                        0.1755656004, &
                                        0.0819879323, &
                                       -0.1244076639, &
                                       -0.0757960081, &
                                       -0.0061621414, &
                                        0.3001894653, &
                                       -0.0875473917, &
                                        0.1721861064, &
                                       -0.0327811055, &
                                       -0.1180073321, &
                                        0.1039972901, &
                                       -0.1458545327, &
                                        0.1322682202, &
                                        0.0807621554, &
                                       -0.0194878504, &
                                       -0.0433178507, &
                                        0.1630209386, &
                                        0.0719023645, &
                                        0.0384608470, &
                                        0.0269149300, &
                                        0.2794769108, &
                                        0.0486097187, &
                                        0.0166578721, &
                                       -0.4039815962, &
                                       -0.0185506605, &
                                        0.1578415036, &
                                        0.1394438297, &
                                        0.0996995419, &
                                        0.0834874138, &
                                        0.0441755019, &
                                        0.0595183112, &
                                        0.0761761367, &
                                       -0.1276389658, &
                                        0.0344679356, &
                                        0.0327335782, &
                                        0.0305291247, &
                                        0.0283773933, &
                                        0.1673222929, &
                                       -0.2469224334, &
                                       -0.0036175600, &
                                       -0.0618411750, &
                                        0.1832969040, &
                                       -0.0879017785, &
                                       -0.0623493753, &
                                        0.0001433615, &
                                        0.1193806827, &
                                       -0.7169522643, &
                                        0.1409975439, &
                                       -0.1106910035, &
                                        0.0000610385, &
                                       -0.0654531941, &
                                        0.0745138675, &
                                        0.0257180817, &
                                        0.0206919834, &
                                        0.0434030220, &
                                       -0.0113068409, &
                                       -0.4931146502, &
                                       -0.0447699539, &
                                        0.0660044327, &
                                       -0.1044563875, &
                                        0.0581403524, &
                                        0.0262230355, &
                                        0.0038860922, &
                                       -0.0622448809, &
                                       -0.0164472666, &
                                        0.0530010648, &
                                        0.0048859403, &
                                        0.2072363943, &
                                       -0.3328768909, &
                                       -0.2331904322, &
                                        0.0927215815, &
                                        0.1431889832, &
                                       -0.0701035112, &
                                       -0.0587990917, &
                                       -0.0942476466, &
                                       -0.0200385526, &
                                        0.2835834026, &
                                       -0.1236337125, &
                                       -0.4036234915, &
                                       -0.0792185888, &
                                        0.0760547072, &
                                        0.0020468512, &
                                        0.0073704729, &
                                        0.0894856602, &
                                        0.4669851363, &
                                       -0.2484049052, &
                                        0.2093657553, &
                                       -0.4941178858, &
                                       -0.1219044030, &
                                       -0.0098460531, &
                                       -0.0919281840, &
                                        0.2219819129, &
                                       -0.0787499100, &
                                        0.2486582249, &
                                        0.2224318981, &
                                       -0.1221390739, &
                                        0.0932841897, &
                                        0.1425740421, &
                                        0.0802589133, &
                                        0.1589632779, &
                                        0.1603790671, &
                                        0.2829410732, &
                                        0.1177494898, &
                                        0.0545351468, &
                                       -0.1056811512, &
                                        0.2162896246, &
                                        0.0628102645, &
                                        0.1789441258, &
                                       -0.0098155160, &
                                        0.1606342047, &
                                       -0.0623672642, &
                                       -0.0495211743, &
                                        0.1151847243, &
                                        0.0488331392, &
                                       -0.1224041209, &
                                       -0.1071720645, &
                                        0.0409216136, &
                                        0.1894682944, &
                                       -0.0639357716, &
                                        0.3548081219, &
                                        0.1161739901, &
                                        0.0077020833, &
                                       -0.0390096679, &
                                       -0.1726941019, &
                                        0.1140052602, &
                                        0.0332625657, &
                                        0.1251280159, &
                                        0.0220201109, &
                                        0.0717099980, &
                                       -0.2075800598, &
                                       -0.2291584909, &
                                       -0.1859041750, &
                                       -0.0899801478, &
                                        0.0186078455, &
                                       -0.1448281854, &
                                        0.0990309194, &
                                        0.0189463459, &
                                       -0.0617795363, &
                                        0.0836330354, &
                                       -0.2020300627, &
                                        0.0971702635, &
                                        0.0590949319, &
                                        0.5910862684, &
                                        0.0620328337, &
                                       -0.0642236173, &
                                        0.2012295127, &
                                        0.1052696779, &
                                        0.1438840330, &
                                        0.3001922965, &
                                       -0.0144472541, &
                                       -0.1407716274, &
                                       -0.8481138945, &
                                        0.1821050346, &
                                        0.1869585812, &
                                       -0.2211140394, &
                                        0.0518066138, &
                                        0.1710071117, &
                                        0.2220394462, &
                                        0.2998422980, &
                                        0.0862190798, &
                                       -0.6651394367, &
                                        0.0035492708, &
                                        0.1073407456, &
                                       -0.1637776494, &
                                        0.0728158727, &
                                        0.3126071095, &
                                        0.0171403140, &
                                        0.0146660535, &
                                       -0.1175294220, &
                                        0.0829260796, &
                                       -0.0389805250, &
                                       -0.3164153397, &
                                       -0.3905045986, &
                                        0.1434183717, &
                                        0.7960040569, &
                                        0.2388304621, &
                                       -0.1716440320, &
                                        0.6739157438, &
                                       -0.0072132451, &
                                        0.0783322155, &
                                        0.3311488330, &
                                        0.1540566385, &
                                       -0.1166704893, &
                                        0.4264467657, &
                                        0.4217605293, &
                                       -0.0821700245, &
                                       -0.1600005478, &
                                       -0.1191665977, &
                                        0.3240189850, &
                                       -0.0239284709, &
                                        0.0160948317, &
                                        0.0130472733, &
                                        0.1024985611, &
                                        0.0844931304, &
                                        0.0742941797, &
                                       -0.0991566256, &
                                       -0.1259906888, &
                                        0.0165303349, &
                                        0.0059021544, &
                                        0.0467252582, &
                                        0.0528995767, &
                                       -0.0103053115, &
                                        0.1519809961, &
                                       -0.1254866868, &
                                        0.2132790089, &
                                        0.0738676637, &
                                       -0.0214318857, &
                                       -0.2075405866, &
                                        0.0774816126, &
                                       -0.1675129086, &
                                        0.1336561888, &
                                        0.1085472330, &
                                        0.0245189313, &
                                        0.1496677548, &
                                       -0.0147583522, &
                                       -0.5091907382, &
                                       -0.1168415174, &
                                       -0.0079255765, &
                                        0.1521315128, &
                                        0.0954194888, &
                                       -0.0789187774, &
                                        0.0576921254, &
                                        0.0301879868, &
                                        0.0867313072, &
                                       -0.1006202474, &
                                       -0.5556714535, &
                                        0.0326815024, &
                                       -0.3185854554, &
                                        0.1176268384, &
                                       -0.3514381945, &
                                        0.1401784271, &
                                       -0.2341466993, &
                                       -0.1058586016, &
                                        0.0285122469, &
                                       -0.3417772651, &
                                        0.0252262056, &
                                        0.4205767810, &
                                        0.0233337767, &
                                        0.6118720174, &
                                       -0.3888663054, &
                                        0.0204654075, &
                                        0.4028838873, &
                                        0.1076263338, &
                                       -0.0364672840, &
                                        0.6145202518, &
                                       -0.5366815925, &
                                       -0.1978487819, &
                                       -0.7961114645, &
                                       -0.0105103804, &
                                       -0.0230901930, &
                                        0.0481223091, &
                                       -0.1928300560, &
                                       -0.1662686318, &
                                        0.2471054047, &
                                       -0.0993628204, &
                                        0.0712678283, &
                                       -0.6099984050, &
                                        0.0328865200, &
                                       -0.0989451259, &
                                        0.2233503610, &
                                        0.2100955844, &
                                       -0.0708990991, &
                                        0.1550537795, &
                                       -0.1607133150, &
                                        0.1502466053, &
                                        0.0424973816, &
                                       -0.2842244506, &
                                        0.0438426808, &
                                       -0.5822857618, &
                                       -0.0542001538, &
                                       -0.7688987255, &
                                        0.0690788776, &
                                       -0.1761187613, &
                                       -0.1784553379, &
                                       -0.0142687261, &
                                       -0.1190623567, &
                                       -0.5786617398, &
                                       -0.0119897379, &
                                        0.1780567467, &
                                       -0.0006244993, &
                                       -0.2654240131, &
                                       -0.1756635010, &
                                       -0.2152282298, &
                                        0.2388044894, &
                                       -0.1637451351, &
                                        0.0199514702, &
                                        0.0149562564, &
                                        0.1858653575, &
                                        0.1238777339, &
                                       -0.1274725646, &
                                        0.0621668734, &
                                       -0.1099683344, &
                                        0.0306253210, &
                                       -0.1807821393, &
                                       -0.1041221172, &
                                        0.0860778764, &
                                        0.0359878093, &
                                       -0.0674280003, &
                                       -0.3543140888, &
                                       -0.2122316062, &
                                        0.3714659512, &
                                       -0.0539012402, &
                                        0.4414963424, &
                                       -0.1371710896, &
                                       -0.2197449505, &
                                        0.3312246203, &
                                       -0.0694102421, &
                                        0.0070448341, &
                                        0.4776154757, &
                                       -0.2859894633, &
                                       -0.0460139513, &
                                       -1.5310714245, &
                                        0.0947657377, &
                                        0.0605536029, &
                                       -0.0666164905, &
                                        0.0656720474, &
                                       -0.0266786702, &
                                        0.3508860469, &
                                        0.0682108179, &
                                       -0.0421167649, &
                                       -0.3776248693, &
                                        0.1060664281, &
                                        0.0340595096, &
                                        0.1102357581, &
                                        0.0021502401, &
                                        0.0686392859, &
                                        0.0208054744, &
                                       -0.0479850546, &
                                       -0.1205734462, &
                                       -0.2397190630, &
                                        0.4118961096, &
                                       -0.0058297710, &
                                       -0.0229369905, &
                                        0.0637242794, &
                                        0.7361154556, &
                                        0.0650805905, &
                                       -0.1588831395, &
                                        0.4611486197, &
                                       -0.0218662210, &
                                        0.1013574004, &
                                        0.2985579967, &
                                       -0.0531940199, &
                                       -0.0347211659, &
                                        0.7369340658, &
                                        0.1123705283, &
                                       -0.0713431612, &
                                        0.2019421309, &
                                       -0.2680284977, &
                                        0.1298256367, &
                                       -0.0357124656, &
                                        0.0007007276, &
                                       -0.0508559979, &
                                       -0.0392882340, &
                                       -0.0192718953, &
                                        0.2775435746, &
                                       -0.1158245429, &
                                       -0.0065615196, &
                                        0.3308299780, &
                                        0.0523004681, &
                                       -0.0174520742, &
                                       -0.0668331981, &
                                        0.0310541987, &
                                        0.4024902582, &
                                       -0.1164814606, &
                                       -0.0489280112, &
                                        0.0330699570, &
                                        0.4826140106, &
                                        0.2852731049, &
                                       -0.1075445116, &
                                        0.1703539193, &
                                        0.0023012022, &
                                        0.0526111685, &
                                        0.4163658321, &
                                        0.2139191926, &
                                        0.0919086039, &
                                       -0.5869889855, &
                                        0.4220768809, &
                                       -0.0548410304, &
                                        0.0021728761, &
                                       -0.1822194308, &
                                        0.1251281649, &
                                        0.2187112272, &
                                       -0.0395595729, &
                                        0.1519016176, &
                                        0.1880267411, &
                                       -0.0003678004, &
                                       -0.0001007926, &
                                       -0.0002140691, &
                                        0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000434008, &
                                       -0.0003228908, &
                                       -0.0000160408, &
                                       -0.0000010619, &
                                       -0.0000000000, &
                                       -0.0000050324, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0001019449, &
                                       -0.0003526604, &
                                        0.0000000000, &
                                       -0.0000000045, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000010540, &
                                       -0.0000155267, &
                                       -0.0000000000, &
                                        0.0000000000, &
                                       -0.0000170752, &
                                       -0.0001914242, &
                                       -0.0003303742, &
                                       -0.0000478387, &
                                       -0.0000000000, &
                                        0.0000001246, &
                                       -0.0000000513, &
                                       -0.0011534365, &
                                        0.0252393428, &
                                        0.0605672412, &
                                        0.1412284076, &
                                       -0.0689411834, &
                                        0.0559015945, &
                                        0.0364971757, &
                                       -0.0182697251, &
                                        0.0726989135, &
                                        0.0661669299, &
                                       -0.2069870383, &
                                        0.0076986989, &
                                       -0.1562052220, &
                                       -0.0487472266, &
                                       -0.2092240453, &
                                        0.0233729817, &
                                        0.2629275918, &
                                       -0.0992095545, &
                                       -0.0401564986, &
                                        0.0277042780, &
                                       -0.0336868428, &
                                       -0.1094377339, &
                                        0.1984216273, &
                                        0.6151635647, &
                                       -0.2494145781, &
                                       -0.0777243078, &
                                       -0.1085220054, &
                                       -0.0442202948, &
                                        0.0112505229, &
                                        0.1167455390, &
                                        0.0452703424, &
                                        0.2682056427, &
                                       -0.0315648466, &
                                        0.0485577732, &
                                        0.5393576622, &
                                        0.0205794647, &
                                       -0.0212994050, &
                                        0.4276633859, &
                                       -0.2434803247, &
                                       -0.2384549677, &
                                        0.0438071899, &
                                        0.1111695543, &
                                        0.0578544550, &
                                        0.0600540489, &
                                       -0.1497028768, &
                                        0.3798491359, &
                                       -0.0043072202, &
                                        0.0353387259, &
                                       -0.1829565316, &
                                       -0.2589347064, &
                                       -0.1400335580, &
                                        0.2429617941, &
                                        0.2608976662, &
                                        0.0088640759, &
                                       -0.0185298268, &
                                        0.1512985975, &
                                        0.3357582092, &
                                        0.0812535286, &
                                       -0.0655503646, &
                                       -0.1933287233, &
                                       -0.0987178013, &
                                       -0.0933284238, &
                                       -0.5860441923, &
                                        0.3005310595, &
                                        0.1317752302, &
                                       -0.1705090702, &
                                        0.1834713221, &
                                        0.0798260868, &
                                        0.1588835120, &
                                        0.2440672815, &
                                        0.2012157291, &
                                        0.1707934737, &
                                        0.0091463625, &
                                       -0.0773419142, &
                                        0.2219623476, &
                                       -0.0331503563, &
                                        0.1188517138, &
                                       -0.0632109493, &
                                        0.0509813651, &
                                       -0.0361976102, &
                                       -0.0368224047, &
                                        0.1557640135, &
                                        0.1414319277, &
                                        0.1991015673, &
                                        0.0337811634, &
                                        0.2369071841, &
                                        0.0593478866, &
                                       -0.7147766352, &
                                       -0.2203466892, &
                                       -0.0927701965, &
                                       -0.0561786704, &
                                        0.0039952612, &
                                        0.0336497985, &
                                       -0.1230057925, &
                                        0.1439912319, &
                                        0.3170579970, &
                                        0.2130197138, &
                                       -0.0862515867, &
                                        0.1650149077, &
                                       -0.0609199181, &
                                        0.1480330080, &
                                       -0.1884803474, &
                                       -0.0873652622, &
                                        0.2371449023, &
                                        0.1898525655, &
                                        0.0785541013, &
                                       -0.0387926437, &
                                       -0.1258729845, &
                                        0.0571407415, &
                                        0.1670406461, &
                                        0.3199642897, &
                                        0.0657927394, &
                                       -0.0299013872, &
                                        0.1424138397, &
                                        0.2041513920, &
                                        0.1288448870, &
                                        0.2744470239, &
                                        0.0269226432, &
                                        0.1632512510, &
                                       -0.3275032938, &
                                       -0.1371985376, &
                                        0.0339576565, &
                                       -0.0958546996, &
                                        0.1207855120, &
                                        0.1013247669, &
                                        0.0085984319, &
                                       -0.1047599241, &
                                        0.2967316210, &
                                        0.0388871692, &
                                       -0.0583380908, &
                                        0.0359266736, &
                                        0.0090975706, &
                                       -0.1654494107, &
                                        0.1566428989, &
                                        0.3269513249, &
                                        0.0715504587, &
                                        0.0585443787, &
                                        0.0154333897, &
                                        0.0953327566, &
                                        0.1434408277, &
                                        0.3889747262, &
                                       -0.1546365023, &
                                       -0.1223082766, &
                                       -0.0967506096, &
                                        0.1639213711, &
                                       -0.1480164677, &
                                        0.0333957449, &
                                        0.0598950125, &
                                       -0.0080853691, &
                                        0.0620859489, &
                                        0.2314299941, &
                                       -0.2880535126, &
                                       -0.3314832449, &
                                        0.1575278938, &
                                        0.0712205619, &
                                        0.1007755473, &
                                       -0.1883654296, &
                                        0.0340248346, &
                                        0.0004599733, &
                                        0.0353181325, &
                                        0.1717206687, &
                                        0.1513105631, &
                                        0.1261746883, &
                                       -0.0582371540, &
                                       -0.3204249442, &
                                       -0.0425060205, &
                                       -0.0392764471, &
                                        0.1714373529, &
                                       -0.0888398811, &
                                       -0.1159959733, &
                                       -0.3023553789, &
                                       -0.2182784528, &
                                       -0.0195081867, &
                                       -0.0111512225, &
                                        0.3804649413, &
                                       -0.1508871913, &
                                       -0.0123492833, &
                                        0.1648868769, &
                                       -0.0552259684, &
                                        0.0521514006, &
                                        0.3593922853, &
                                       -1.1322450638, &
                                       -0.2467958778, &
                                       -1.1144685745, &
                                        0.0005213400, &
                                        0.2050558776, &
                                        0.2434104979, &
                                        0.1095552593, &
                                        0.0213230047, &
                                       -0.0216197055, &
                                        0.1748775840, &
                                       -0.2520259321, &
                                       -0.6226849556, &
                                       -0.3023624122, &
                                       -0.0523029566, &
                                        0.0126420809, &
                                       -0.0615549944, &
                                       -0.1988618821, &
                                        0.2032747418, &
                                       -0.1410912126, &
                                        0.1508759558, &
                                        0.0883782804, &
                                        0.0184573848, &
                                        0.0557601675, &
                                        0.0473123789, &
                                       -0.2628019452, &
                                       -0.4593799710, &
                                       -0.0262901355, &
                                        0.0776707530, &
                                       -0.0714293942, &
                                        0.1825676113, &
                                       -0.1218449175, &
                                       -0.1240133271, &
                                       -0.2043749690, &
                                        0.1969949305, &
                                        0.1170165539, &
                                       -0.6575689912, &
                                       -0.1207907572, &
                                        0.1278477013, &
                                        0.1059808806, &
                                        0.0162431709, &
                                       -0.0491987839, &
                                        0.1822419167, &
                                        0.0106605720, &
                                        0.0634038448, &
                                        0.0356501602, &
                                        0.1768192500, &
                                        0.1014329419, &
                                        0.2267792672, &
                                        0.2253935039, &
                                        0.0909684002, &
                                       -0.0011884473, &
                                        0.0215470232, &
                                       -0.1643531770, &
                                        0.0312650837, &
                                       -0.1817112118, &
                                       -0.2990985513, &
                                        0.1218536943, &
                                        0.0311620981, &
                                        0.1708617955, &
                                        0.0253082775, &
                                        0.1281378716, &
                                        0.1284774840, &
                                        0.1792393029, &
                                       -0.1690402180, &
                                        0.2279612422, &
                                       -0.0102423383, &
                                       -0.1433539242, &
                                       -0.0209966693, &
                                        0.1025780961, &
                                       -0.0432269387, &
                                        0.1149162352, &
                                       -0.0417404920, &
                                       -0.2172163874, &
                                       -0.1094222739, &
                                       -0.0443894416, &
                                       -0.2153322250, &
                                       -0.5173802972, &
                                       -0.0744062811, &
                                       -0.4163934886, &
                                        0.1452930868, &
                                       -0.4439324439, &
                                       -0.0765491277, &
                                        0.0463704318, &
                                       -0.1280564070, &
                                       -0.0853528231, &
                                       -0.2945142984, &
                                       -0.1809945256, &
                                        0.3955119252, &
                                       -0.0976085365, &
                                        0.5074393153, &
                                       -0.2301838845, &
                                       -0.1209731102, &
                                        0.5012450814, &
                                        0.1116867289, &
                                        0.1222359017, &
                                        0.5662669539, &
                                       -0.4310859740, &
                                       -0.2465763539, &
                                       -1.2777043581, &
                                        0.1187892258, &
                                        0.0800516829, &
                                        0.0794656500, &
                                       -0.0701394752, &
                                       -0.2508227527, &
                                        0.2678167522, &
                                       -0.1918657571, &
                                        0.0815698206, &
                                       -0.2019447088, &
                                        0.1817022562, &
                                       -0.0146257645, &
                                        0.0517141670, &
                                        0.0040531964, &
                                       -0.0675665587, &
                                        0.0263046548, &
                                        0.1557191461, &
                                        0.1252867281, &
                                        0.0437989719, &
                                       -0.0916393325, &
                                        0.0598003827, &
                                       -0.1584980339, &
                                        0.0677021593, &
                                       -0.1815793961, &
                                        0.0608588718, &
                                        0.0782625228, &
                                       -0.0686439276, &
                                        0.1416548193, &
                                        0.2397148162, &
                                       -0.0571622699, &
                                        0.1192254722, &
                                        0.2128000557, &
                                        0.5642579198, &
                                       -0.0402314104, &
                                        0.1276806146, &
                                       -0.0671775863, &
                                       -0.1789154261, &
                                        0.0402404517, &
                                        0.1159293503, &
                                       -0.0916855559, &
                                        0.0746348277, &
                                        0.0330934227, &
                                        0.0344636105, &
                                       -0.0481605008, &
                                        0.1161096469, &
                                       -0.0338472612, &
                                        0.1099651530, &
                                       -0.0351596661, &
                                        0.0174193904, &
                                       -0.0829667747, &
                                        0.1206222400, &
                                       -0.0975277945, &
                                        0.2338077128, &
                                        0.2551747262, &
                                        0.1492981613, &
                                        0.4087337255, &
                                        0.1121237352, &
                                       -0.0101339407, &
                                        0.2673093677, &
                                        0.0378999077, &
                                        0.0535292253, &
                                        0.2094783485, &
                                        0.2578415573, &
                                        0.0254251845, &
                                        0.4210065901, &
                                        0.3514422774, &
                                        0.0497496054, &
                                       -0.0967936739, &
                                       -0.2676246166, &
                                       -0.1278011203, &
                                        0.1023878157, &
                                        0.1826643944, &
                                        0.1263880879, &
                                       -0.2578767538, &
                                       -0.1171162575, &
                                        0.0542697161, &
                                       -0.1261904240, &
                                        0.1824838370, &
                                       -0.0968704373, &
                                        0.0891660750, &
                                       -0.0875684991, &
                                        0.2139808387, &
                                       -0.0360888503, &
                                        0.0237006601, &
                                        0.2266170979, &
                                        0.3011629879, &
                                       -0.0430485606, &
                                        0.1788635403, &
                                       -0.0404089317, &
                                        0.1313267946, &
                                        0.0311700255, &
                                       -0.0296613649, &
                                        0.1633984745, &
                                        0.1313209683, &
                                       -0.1025299877, &
                                        0.0575697273, &
                                       -0.3947864771, &
                                        0.0492355414, &
                                        0.2074911147, &
                                        0.0511498973, &
                                        0.2408272624, &
                                       -0.0420812853, &
                                        0.1766870767, &
                                        0.0631889477, &
                                        0.2733637393, &
                                       -0.0631792545, &
                                       -0.0221331753, &
                                        0.2238198668, &
                                        0.0226980764, &
                                        0.1627410501, &
                                        0.3404597342, &
                                        0.1632103920, &
                                        0.1043343842, &
                                       -0.0368773192, &
                                        0.1842046231, &
                                        0.4341236055, &
                                        0.0165265501, &
                                       -0.0018874981, &
                                        0.2331946641, &
                                       -0.2626870573, &
                                        0.1456575245, &
                                        0.0413499400, &
                                        0.2622506618, &
                                        0.0386682376, &
                                        0.3127145767, &
                                       -0.4688608348, &
                                        0.1529965699, &
                                       -0.1823520213, &
                                       -0.7795903683, &
                                       -0.1377466619, &
                                       -0.0704569221, &
                                       -0.0572680049, &
                                       -0.0076565170, &
                                        0.1071244031, &
                                        0.0275518931, &
                                       -0.3758726716, &
                                        0.2206305861, &
                                       -0.1030078158, &
                                        0.0761107653, &
                                        0.0469661094, &
                                        0.2843365073, &
                                        0.1577776372, &
                                        0.1680440754, &
                                        0.1591504961, &
                                        0.2437966019, &
                                        0.0217074025, &
                                        0.0057128468, &
                                       -0.1214469671, &
                                        0.3136784136, &
                                       -0.0071931928, &
                                        0.1374237090, &
                                        0.1034179255, &
                                        0.0159358196, &
                                        0.2512319684, &
                                        0.0116600329, &
                                        0.1102654114, &
                                        0.2008789033, &
                                        0.1339068860, &
                                       -0.2167874724, &
                                       -0.0169028267, &
                                        0.3449572623, &
                                        0.2125499249, &
                                        0.0609562881, &
                                       -0.1319775134, &
                                       -0.0187374391, &
                                        0.0392745882, &
                                        0.1629555374, &
                                        0.0023398488, &
                                        0.0529444069, &
                                       -0.0942757726, &
                                       -0.1724073440, &
                                       -0.1197245419, &
                                       -0.1490973234, &
                                        0.1528967619, &
                                        0.0655223653, &
                                       -0.1338297427, &
                                        0.1446604282, &
                                        0.0852201059, &
                                        0.0302346814, &
                                        0.1701141745, &
                                        0.1092767343, &
                                        0.1091540679, &
                                        0.2137951106, &
                                       -0.0349724181, &
                                       -0.0578171201, &
                                       -0.0254878551, &
                                       -0.0918029249, &
                                       -0.0473424233, &
                                        0.0407084115, &
                                        0.0725131482, &
                                        0.0212761499, &
                                        0.2132104933, &
                                       -0.1153411418, &
                                       -0.2566856444, &
                                        0.1708658338, &
                                        0.1792775691, &
                                        0.3271785080, &
                                        0.2202324420, &
                                       -0.0381870344, &
                                        0.0187594965, &
                                        0.1653767228, &
                                        0.0855267569], &
                                       [32, 32] )
            layer3_weights = reshape( [ 0.0029595317, &
                                        0.0090058185, &
                                       -0.0296032261, &
                                       -0.0622257441, &
                                        0.0219737906, &
                                        0.1441209465, &
                                        0.1496275067, &
                                       -0.0582581647, &
                                       -0.0533791482, &
                                       -0.0248202719, &
                                        0.0161084346, &
                                       -0.0000000018, &
                                        0.0127525805, &
                                       -0.0130605027, &
                                       -0.0678775981, &
                                        0.0075119003, &
                                        0.0000000000, &
                                        0.0043050856, &
                                       -0.0935970172, &
                                       -0.0102723408, &
                                       -0.0627882779, &
                                        0.0446935482, &
                                        0.0206251293, &
                                       -0.0182138346, &
                                        0.0025062438, &
                                        0.0000007382, &
                                        0.0088261347, &
                                       -0.0455608070, &
                                       -0.1256708652, &
                                        0.0053051887, &
                                       -0.0500280894, &
                                        0.1318337619, &
                                       -1.3192064762, &
                                       -0.0820875913, &
                                       -0.0056390702, &
                                        0.2295784205, &
                                       -0.0013250347, &
                                        0.0175024327, &
                                        0.1574810743, &
                                        0.0872745141, &
                                       -0.1040187702, &
                                       -0.3956167698, &
                                        0.0945519879, &
                                       -0.7043093443, &
                                       -0.1658922732, &
                                       -0.6513203979, &
                                       -0.6749840975, &
                                        0.0118613187, &
                                        0.0000113615, &
                                        0.1494562626, &
                                       -0.4042855799, &
                                        0.1677936763, &
                                       -0.0483510941, &
                                        0.2819423378, &
                                       -0.7623726726, &
                                        0.2022211552, &
                                       -0.1580482870, &
                                       -0.6730184555, &
                                        0.0480773188, &
                                       -0.1216825396, &
                                        0.0736446902, &
                                        0.2131082714, &
                                        0.0300587229, &
                                       -0.1033407226, &
                                       -1.0300651789, &
                                        0.1504736692, &
                                       -0.0657825023, &
                                        0.1999217719, &
                                        0.0407993793, &
                                        0.3515218198, &
                                        0.0850677043, &
                                       -0.0460699461, &
                                       -0.0145037947, &
                                        0.2682029605, &
                                       -0.1110557467, &
                                       -0.8825362921, &
                                       -0.1748940200, &
                                       -0.3661963642, &
                                       -0.4077774584, &
                                       -0.0564054064, &
                                        0.0000100334, &
                                        0.1848580390, &
                                        0.0926762298, &
                                        0.2145613581, &
                                        0.0041485624, &
                                        0.2210744321, &
                                       -0.3712910414, &
                                        0.1861020774, &
                                       -0.0453116857, &
                                       -0.7313112617, &
                                        0.1033395007, &
                                        0.3335626423, &
                                        0.0016870539, &
                                        0.1775100231, &
                                       -0.0801045969, &
                                       -0.0804040805, &
                                       -0.1723919809, &
                                        0.3386634588, &
                                       -1.0811138153, &
                                       -0.1542388052, &
                                       -0.1539994180, &
                                       -0.3163450956, &
                                       -0.3634785116, &
                                        0.2184986025, &
                                       -0.5574039817, &
                                        0.3052888513, &
                                       -0.0487313680, &
                                       -0.0272801481, &
                                       -0.6302235723, &
                                       -0.0699116290, &
                                        0.2838917077, &
                                        0.0896317363, &
                                       -0.0000002935, &
                                       -0.0919198021, &
                                        0.1068101898, &
                                        0.2489095181, &
                                       -0.0957259759, &
                                        0.0083764242, &
                                       -0.4777595401, &
                                        0.0442956984, &
                                        0.2205126286, &
                                       -0.1342294365, &
                                        0.0390908122, &
                                        0.0902163982, &
                                       -0.0319491439, &
                                        0.2913528681, &
                                       -0.3448360264, &
                                        0.1422698945, &
                                       -0.7607815862, &
                                        0.1493487507, &
                                       -0.0541883595, &
                                        0.0774365067, &
                                       -0.1214134246, &
                                        0.3468166888, &
                                        0.0402036421, &
                                        0.1022841185, &
                                       -0.2091278881, &
                                        0.3019505739, &
                                        0.0482904017, &
                                       -0.8911399841, &
                                       -0.1626002938, &
                                       -0.2637581527, &
                                       -0.4769928157, &
                                        0.0667123348, &
                                        0.0000005590, &
                                       -0.0504992642, &
                                        0.1170678660, &
                                        0.0506535992, &
                                        0.0982595980, &
                                       -0.0536769293, &
                                       -0.5192965269, &
                                        0.0917206183, &
                                        0.0980465040, &
                                       -0.3712622225, &
                                        0.1176029444, &
                                        0.1352909505, &
                                        0.0411170870, &
                                       -0.0026011388, &
                                        0.2221890092, &
                                        0.1105686575, &
                                       -0.8503743410, &
                                       -0.0975795984, &
                                        0.0947187021, &
                                        0.0832282603, &
                                        0.0146110067, &
                                        0.3657937348, &
                                        0.0788999945, &
                                        0.1860837042, &
                                       -0.1234655008, &
                                        0.3020770550, &
                                       -0.0618038140, &
                                       -0.7459743023, &
                                       -0.3236008286, &
                                       -0.2909274399, &
                                       -0.4597806334, &
                                        0.1433775872, &
                                        0.0000005150, &
                                       -0.1038464680, &
                                        0.1756143570, &
                                       -0.0868480131, &
                                        0.0071412777, &
                                       -0.0110968668, &
                                       -0.2338258624, &
                                        0.0530101843, &
                                        0.0327210277, &
                                       -0.5045275688, &
                                        0.1568397135, &
                                        0.1716569066, &
                                        0.2206671536, &
                                        0.0100658825, &
                                        0.0782239363, &
                                       -0.1587873250, &
                                        1.2915695906, &
                                       -0.0107920859, &
                                       -0.0074519380, &
                                       -0.5299015641, &
                                        0.1012578979, &
                                        0.1494492888, &
                                        0.3216714561, &
                                       -0.1193587035, &
                                        0.2379832864, &
                                       -0.3002684414, &
                                        0.2907764018, &
                                        0.9359669685, &
                                       -0.1535051912, &
                                        0.4355154634, &
                                        0.7823821902, &
                                        0.1853024662, &
                                       -0.0000000000, &
                                       -0.3343707323, &
                                       -0.0442050844, &
                                        0.1146443412, &
                                       -0.0571770668, &
                                        0.1063571498, &
                                        0.8908424973, &
                                       -0.4116037786, &
                                       -0.0892797634, &
                                        0.6639662981, &
                                       -0.3329808414, &
                                       -0.2111178190, &
                                        0.2082416415, &
                                        0.1181550249, &
                                       -0.2501609027, &
                                        0.0776218325, &
                                       -1.2516877651, &
                                        0.1469940990, &
                                        0.1151548102, &
                                        0.0243497193, &
                                       -0.1913783848, &
                                        0.2282439321, &
                                        0.0121522173, &
                                        0.2378721535, &
                                       -0.0524463430, &
                                       -0.0030095328, &
                                       -0.0722608641, &
                                       -0.5974720120, &
                                        0.3155088425, &
                                       -0.5203338861, &
                                       -0.3569336832, &
                                        0.1812880337, &
                                        0.0000003911, &
                                        0.0551191382, &
                                       -0.3738975227, &
                                        0.1440198720, &
                                        0.2720023692, &
                                       -0.0492791869, &
                                       -0.0894519836, &
                                        0.1361162961, &
                                       -0.0062772329, &
                                       -0.8500992656, &
                                        0.1329735965, &
                                        0.4438349605, &
                                        0.0305008255, &
                                        0.0248852596, &
                                        0.0738746151, &
                                       -0.0914160162, &
                                       -0.0575578883, &
                                        0.0870289654, &
                                        0.0174438301, &
                                       -0.1088399440, &
                                       -0.0143482508, &
                                        0.6664773822, &
                                        0.2935282290, &
                                       -0.0919989422, &
                                        0.2077460885, &
                                        0.5431715250, &
                                       -0.4222048819, &
                                        0.3688005805, &
                                        0.1484459192, &
                                       -0.1417748928, &
                                       -0.1514323056, &
                                        0.0551702417, &
                                        0.0000000001, &
                                       -0.3137323260, &
                                        0.0266917292, &
                                       -0.0909171402, &
                                        0.1342308521, &
                                       -0.1140848696, &
                                        0.4381492734, &
                                       -0.4039449096, &
                                        0.0043136566, &
                                        0.1611818522, &
                                       -0.0626403093, &
                                        0.3275003135, &
                                        0.0572265424, &
                                       -0.1586574465, &
                                        0.0734435394, &
                                        0.0781624541, &
                                        1.2648596764, &
                                        0.2011868358, &
                                       -0.0070247590, &
                                       -0.6028591394, &
                                       -0.0763859078, &
                                       -0.4807381630, &
                                       -0.5073332787, &
                                        0.0445722938, &
                                       -0.3268344998, &
                                        0.2524425685, &
                                       -0.0294421092, &
                                        0.6575056911, &
                                       -0.8432107568, &
                                        0.8557381630, &
                                        0.2628165483, &
                                        0.1220464334, &
                                       -0.0000024663, &
                                        0.0598092936, &
                                        0.4299706221, &
                                        0.1670757979, &
                                        0.1497493237, &
                                       -0.0524509363, &
                                        0.0614173263, &
                                       -0.4418860078, &
                                        0.0514344722, &
                                        0.6840224862, &
                                        0.0744889230, &
                                        0.1144858524, &
                                        0.0627736375, &
                                        0.2769304514, &
                                        0.0100379270, &
                                        0.0210083332, &
                                        1.0150130987, &
                                       -0.1125183702, &
                                        0.2631434202, &
                                       -0.3181472123, &
                                        0.0079008276, &
                                       -0.3724161088, &
                                        0.0246114787, &
                                       -0.0097892871, &
                                        0.0305190552, &
                                       -0.1209841073, &
                                        0.3068799973, &
                                        0.9264600277, &
                                        0.0865538418, &
                                        0.6460213065, &
                                        0.5097970963, &
                                        0.1632121652, &
                                       -0.0000254921, &
                                        0.0547567382, &
                                        0.1086037457, &
                                        0.2993905544, &
                                        0.1430515051, &
                                        0.2373887002, &
                                        0.6723778248, &
                                       -0.1517256647, &
                                        0.1263825595, &
                                        0.4838920832, &
                                        0.0318814851, &
                                       -0.2062053382, &
                                        0.2899146080, &
                                        0.0217451248, &
                                       -0.0969579965, &
                                        0.3072587550, &
                                        1.1701557636, &
                                       -0.1142417341, &
                                        0.1012746543, &
                                        0.0115403244, &
                                        0.2641918659, &
                                       -0.3837465942, &
                                        0.2956894636, &
                                       -0.0923724696, &
                                        0.2569755614, &
                                       -0.0465541445, &
                                        0.2161802948, &
                                        1.0294393301, &
                                        0.2940576375, &
                                        0.5541933775, &
                                        0.4993808866, &
                                       -0.1223170906, &
                                       -0.0000069199, &
                                       -0.0265244264, &
                                       -0.0805728585, &
                                        0.1677181870, &
                                        0.2056434751, &
                                        0.1986000091, &
                                        0.5876498222, &
                                        0.0080911266, &
                                        0.1301403344, &
                                        0.6403306127, &
                                        0.1148284152, &
                                       -0.0060276934, &
                                        0.1772596389, &
                                       -0.1336751282, &
                                        0.0361822508, &
                                        0.0517907664, &
                                        0.0654147789, &
                                        0.1626176089, &
                                       -0.9424691200, &
                                        0.0005494469, &
                                        0.1631125063, &
                                        0.4279237390, &
                                       -0.1109365895, &
                                       -0.1513663530, &
                                        0.3317438066, &
                                        0.3871226609, &
                                       -0.0713736340, &
                                       -0.2759961784, &
                                       -0.2217999548, &
                                        0.0501509309, &
                                       -0.6122264266, &
                                        0.2675771415, &
                                        0.0000007795, &
                                       -0.0130298184, &
                                        0.0114761656, &
                                        0.1755229086, &
                                       -0.0771123767, &
                                       -0.1647227854, &
                                       -0.3996969759, &
                                        0.0818450972, &
                                        0.0536308847, &
                                       -0.2203207314, &
                                       -0.1715206802, &
                                        0.1358259022, &
                                       -0.0917946175, &
                                        0.0531425253, &
                                        0.0236165598, &
                                        0.0913984030, &
                                       -1.1441136599, &
                                        0.1263262033, &
                                       -0.0995009243, &
                                        0.1604755670, &
                                        0.2330702841, &
                                        0.3868108988, &
                                       -0.0453863703, &
                                        0.0808796659, &
                                       -0.1873354614, &
                                        0.3261315227, &
                                        0.0344883613, &
                                       -0.8705798984, &
                                       -0.4747884870, &
                                       -0.5637400150, &
                                       -0.4779713452, &
                                        0.1516129971, &
                                        0.0000063696, &
                                        0.1321959943, &
                                       -0.0266117528, &
                                       -0.0899885744, &
                                        0.0117642656, &
                                       -0.1089888215, &
                                       -0.5420552492, &
                                        0.0179780629, &
                                       -0.0131205888, &
                                       -0.5074701905, &
                                       -0.0053862552, &
                                        0.2396454215, &
                                        0.1713524312, &
                                        0.1568507999, &
                                        0.2280106395, &
                                       -0.0761898905, &
                                       -1.1481472254, &
                                       -0.0333988816, &
                                       -0.1729665846, &
                                        0.0877336413, &
                                        0.2026506811, &
                                        0.4213358760, &
                                        0.0487712882, &
                                        0.2026512474, &
                                        0.0416640304, &
                                        0.2311692536, &
                                        0.0957469195, &
                                       -0.8166998029, &
                                       -0.2620595992, &
                                       -0.4605218470, &
                                       -0.5329739451, &
                                       -0.0700469315, &
                                        0.0000126760, &
                                        0.0388714597, &
                                        0.3060767949, &
                                        0.0879039466, &
                                        0.1176554039, &
                                        0.0759868547, &
                                       -0.6651532650, &
                                       -0.0496077016, &
                                        0.0538773164, &
                                       -0.6665345430, &
                                        0.1855683774, &
                                        0.2839422524, &
                                       -0.0095223933, &
                                       -0.0128510175, &
                                        0.2202306837, &
                                       -0.0590058006, &
                                        1.0862194300, &
                                       -0.1010753363, &
                                        0.3070189655, &
                                       -0.0077820360, &
                                        0.0197811630, &
                                        0.0000000000, &
                                        0.1866157055, &
                                        0.0020997373, &
                                        0.1018090546, &
                                       -0.7802265882, &
                                        0.2030945867, &
                                        0.8530374169, &
                                        0.2655357420, &
                                        0.2788033187, &
                                        0.3752801418, &
                                       -0.1610573977, &
                                       -0.0000003043, &
                                       -0.1562257707, &
                                       -0.1581627131, &
                                        0.2142893672, &
                                        0.0147527941, &
                                        0.0802548379, &
                                        0.7306733727, &
                                       -0.1902145445, &
                                       -0.0806044415, &
                                        0.4299648702, &
                                       -0.3037132621, &
                                        0.3045186996, &
                                        0.2065479010, &
                                       -0.1472414285, &
                                        0.0091257757, &
                                        0.0193551667, &
                                        0.9001638889, &
                                       -0.2227559835, &
                                        0.2075011581, &
                                       -0.1355733424, &
                                        0.3171845973, &
                                       -0.3059578538, &
                                        0.1152557358, &
                                        0.0723241568, &
                                        0.3627367914, &
                                        0.1588606536, &
                                        0.2516418397, &
                                        0.8799405694, &
                                       -0.2031978518, &
                                        0.4188973010, &
                                        0.4873706102, &
                                       -0.1099282429, &
                                       -0.0000039924, &
                                       -0.1262661219, &
                                        0.3149235547, &
                                        0.1391668916, &
                                        0.2542135119, &
                                        0.0504292175, &
                                        0.5929861665, &
                                       -0.0412572250, &
                                        0.1796409935, &
                                        0.7935263515, &
                                        0.0123333614, &
                                       -0.1260818094, &
                                        0.1336666495, &
                                        0.0696191415, &
                                        0.1160134673, &
                                        0.2784451246, &
                                       -1.2663985491, &
                                       -0.2432244867, &
                                        0.1055066586, &
                                        0.2735822499, &
                                        0.0794671476, &
                                        0.5184895396, &
                                       -0.0853598565, &
                                        0.0088296179, &
                                       -0.2737787962, &
                                       -0.2193343341, &
                                       -0.0256137047, &
                                       -0.6845768690, &
                                       -0.1597333401, &
                                       -0.6861891747, &
                                       -0.5762760639, &
                                       -0.1062585041, &
                                        0.0000566400, &
                                       -0.0537394658, &
                                       -0.1587169319, &
                                        0.1444551200, &
                                       -0.0482344925, &
                                        0.2688489556, &
                                       -0.7584124804, &
                                        0.0341009051, &
                                        0.0379309207, &
                                       -0.6358917356, &
                                        0.0602680929, &
                                       -0.1995220184, &
                                        0.0743929967, &
                                        0.2787412107, &
                                        0.1485405862, &
                                       -0.1044813246, &
                                       -0.0174264200, &
                                       -0.0179853626, &
                                       -1.0850079060, &
                                        0.0308057424, &
                                       -0.0095259333, &
                                       -0.0970308259, &
                                       -0.3313529193, &
                                        0.2603632510, &
                                       -0.0983251110, &
                                        0.3577705920, &
                                       -0.3358022273, &
                                       -0.0875237808, &
                                        0.0067135063, &
                                       -0.0910850465, &
                                        0.0482002385, &
                                        0.2719935775, &
                                        0.0000000000, &
                                       -0.0217150468, &
                                       -0.0179758109, &
                                        0.0734353885, &
                                       -0.0724528804, &
                                       -0.1908912808, &
                                       -0.2046634704, &
                                        0.0471580066, &
                                        0.0113380030, &
                                        0.0129048387, &
                                        0.2327907532, &
                                        0.0223878901, &
                                       -0.2889737785, &
                                        0.0934478566, &
                                       -0.1948515177, &
                                        0.1768151820, &
                                       -1.2427281141, &
                                        0.0747867674, &
                                        0.0431772694, &
                                        0.2500873506, &
                                        0.0645332038, &
                                        0.3438171446, &
                                       -0.1004485637, &
                                       -0.0811988413, &
                                        0.1835138649, &
                                        0.5434736013, &
                                       -0.0090056974, &
                                       -1.1602915525, &
                                       -0.6105638742, &
                                       -0.2101620138, &
                                       -0.4054845572, &
                                       -0.0674730837, &
                                        0.0000162218, &
                                       -0.2226020992, &
                                        0.3518669903, &
                                        0.1488138586, &
                                        0.1043110043, &
                                       -0.1349910200, &
                                       -0.7128469944, &
                                        0.2267374694, &
                                        0.1976201832, &
                                       -0.3350920975, &
                                       -0.1438626200, &
                                       -0.1019767076, &
                                        0.0944675505, &
                                        0.2323347777, &
                                        0.0585812442, &
                                       -0.0252582766, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                        0.0000000000, &
                                        0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                        0.0000000000, &
                                        0.0000000000, &
                                        0.0000000000, &
                                       -0.0000000000, &
                                        0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                        0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                        0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.0000000000, &
                                       -0.3831882775, &
                                        0.0392826460, &
                                       -0.9635210037, &
                                        0.0290449597, &
                                        0.0902972668, &
                                        0.4385885298, &
                                       -0.3529461622, &
                                        0.1343071610, &
                                        0.4854924679, &
                                        0.0795574710, &
                                        0.0584950373, &
                                       -0.4487818480, &
                                       -0.0943075269, &
                                       -0.2240304202, &
                                       -0.5364055037, &
                                        0.2910577655, &
                                        0.0000065363, &
                                       -0.0919014588, &
                                        0.1115423813, &
                                        0.0457112268, &
                                        0.2247323394, &
                                       -0.1082175523, &
                                       -0.8102955818, &
                                       -0.1650563031, &
                                        0.1804188639, &
                                       -0.1099387333, &
                                        0.0026820509, &
                                        0.2338677049, &
                                       -0.0812218413, &
                                        0.1370468885, &
                                       -0.0778756887, &
                                       -0.0735909119, &
                                        0.6542812586, &
                                       -0.1420951337, &
                                       -0.0205828901, &
                                        0.0943283439, &
                                        0.2492242903, &
                                        0.0558623187, &
                                        0.0301871449, &
                                       -0.0825531557, &
                                        0.1441941112, &
                                        0.1656639874, &
                                        0.0600710697, &
                                       -0.0202430803, &
                                       -0.2312006056, &
                                        0.4410596788, &
                                        0.1595488638, &
                                        0.0149367275, &
                                        0.0000000067, &
                                        0.0158669278, &
                                        0.3758672476, &
                                        0.0829674676, &
                                       -0.1305790991, &
                                       -0.1083717197, &
                                        0.0556283742, &
                                        0.0161781497, &
                                        0.1659715623, &
                                        0.6274415255, &
                                        0.2086175680, &
                                        0.0111174192, &
                                       -0.0024683098, &
                                        0.1175947860, &
                                        0.1474395841, &
                                        0.0975216180, &
                                       -0.5002129674, &
                                        0.0448617041, &
                                        0.1204283684, &
                                       -0.0645291209, &
                                        0.0249200035, &
                                       -0.0000000000, &
                                        0.2224408984, &
                                       -0.0379984938, &
                                       -0.1856210381, &
                                       -1.2246602774, &
                                       -0.0890906900, &
                                        0.1805234998, &
                                        0.2979910672, &
                                       -0.2122387141, &
                                       -0.1680485457, &
                                       -0.3059941530, &
                                        0.0000001623, &
                                        0.1387332380, &
                                       -1.3985445499, &
                                        0.0518161021, &
                                       -0.0115576172, &
                                        0.2574613392, &
                                        0.1335090995, &
                                        0.2154838741, &
                                       -0.2899040282, &
                                       -0.6028097868, &
                                        0.0225453805, &
                                        0.0096720792, &
                                        0.0530407093, &
                                       -0.3422836959, &
                                       -0.0811435059, &
                                        0.0284242164, &
                                       -1.2585178614, &
                                        0.2620376647, &
                                       -0.0624236017, &
                                        0.3060331643, &
                                        0.0932540447, &
                                        0.3694374859, &
                                       -0.1101653129, &
                                        0.1531318426, &
                                       -0.0521552078, &
                                        0.0340161100, &
                                       -0.1398839355, &
                                       -0.7333945632, &
                                       -0.0321698822, &
                                       -0.5835276246, &
                                       -0.4862317443, &
                                        0.2249585241, &
                                        0.0000092393, &
                                       -0.1360787898, &
                                        0.0975940898, &
                                        0.0016650733, &
                                       -0.0123410253, &
                                        0.1236274019, &
                                       -0.5252228379, &
                                        0.2515418828, &
                                        0.1966846734, &
                                       -0.4250454009, &
                                        0.0409463942, &
                                        0.2500912845, &
                                        0.2119983733, &
                                        0.2215826958, &
                                        0.0220922790, &
                                       -0.0627835989, &
                                       -0.6489841938, &
                                        0.2184381932, &
                                        0.0912366956, &
                                        0.1497198492, &
                                       -0.1592324525, &
                                        0.2668383420, &
                                       -0.1680341214, &
                                        0.2335373461, &
                                       -0.0422845073, &
                                        0.1689817756, &
                                       -0.2220115960, &
                                       -0.4404020011, &
                                        0.0509573855, &
                                       -0.5172415972, &
                                       -0.2625385821, &
                                        0.0160009656, &
                                        0.0000013224, &
                                        0.0177671071, &
                                       -0.0422266871, &
                                        0.2308739573, &
                                        0.1080126539, &
                                        0.1945403069, &
                                       -0.3319953680, &
                                       -0.0540069453, &
                                       -0.1916699857, &
                                       -0.5043299198, &
                                        0.1386546046, &
                                        0.3335401714, &
                                        0.1312463433, &
                                       -0.1341532618, &
                                        0.1219504923, &
                                       -0.1628730744, &
                                        0.9239445925, &
                                       -0.2025306970, &
                                        0.1969852298, &
                                       -0.2788475454, &
                                        0.3034005761, &
                                       -0.3777188361, &
                                        0.1791269630, &
                                       -0.0748336613, &
                                        0.3290737569, &
                                       -0.2381247282, &
                                        0.0511842556, &
                                        0.8143504858, &
                                        0.3063666224, &
                                        0.3761483729, &
                                        0.6604206562, &
                                       -0.1273156554, &
                                       -0.0000055663, &
                                       -0.0954042748, &
                                       -0.1361778677, &
                                        0.2511064410, &
                                        0.2725174129, &
                                        0.2591962516, &
                                        0.4505026340, &
                                       -0.0813230351, &
                                       -0.0381915346, &
                                        0.4168652296, &
                                       -0.0879421309, &
                                       -0.0531791188, &
                                        0.1885081530, &
                                       -0.0504380018, &
                                        0.1066954955, &
                                        0.0806551576, &
                                        0.0717923790, &
                                       -0.0070065153, &
                                       -0.0115202935, &
                                        0.0267332066, &
                                        0.0235704686, &
                                        0.0000000000, &
                                       -0.0856559426, &
                                       -0.0198490247, &
                                        0.0846263915, &
                                       -0.0000092371, &
                                       -0.0000000000, &
                                        0.0454437248, &
                                       -0.0000000000, &
                                        0.0564810671, &
                                        0.0000000000, &
                                       -0.0254675318, &
                                       -0.0000000000, &
                                       -0.0003917576, &
                                        0.0261080302, &
                                       -0.0165989287, &
                                       -0.1188118234, &
                                       -0.0105545828, &
                                        0.0843194053, &
                                        0.0312368087, &
                                        0.0841009989, &
                                       -0.0083332313, &
                                        0.0000052772, &
                                       -0.0499388203, &
                                       -0.0879863948, &
                                       -0.0001057572, &
                                       -0.0000678299, &
                                       -0.0483629182, &
                                        1.2928377390, &
                                        0.0669198483, &
                                        0.1822876483, &
                                       -0.0237828009, &
                                        0.1761308908, &
                                       -0.3484397829, &
                                        0.3297292292, &
                                       -0.0518289991, &
                                        0.2286986113, &
                                        0.0630639344, &
                                        0.1980856955, &
                                        1.0450674295, &
                                        0.0591437779, &
                                        0.6008735895, &
                                        0.3692144752, &
                                        0.0525730252, &
                                       -0.0000048159, &
                                       -0.1002645418, &
                                        0.1497148424, &
                                        0.1147855520, &
                                        0.1127405092, &
                                        0.1094121486, &
                                        0.8031584620, &
                                       -0.0438197330, &
                                        0.2848002315, &
                                        0.9111849666, &
                                       -0.1580739915, &
                                       -0.2660928667, &
                                        0.3191884756, &
                                        0.2379714996, &
                                        0.0633445755, &
                                       -0.0006074837, &
                                        1.3138337135, &
                                       -0.0359422639, &
                                        0.3722144365, &
                                       -0.1404595524, &
                                        0.1471060812, &
                                       -0.3785413802, &
                                        0.2391000390, &
                                       -0.1034604684, &
                                        0.1474892497, &
                                       -0.0584335476, &
                                        0.0197902806, &
                                        1.0596722364, &
                                       -0.0184688848, &
                                        0.6222655177, &
                                        0.5178989768, &
                                        0.1769666672, &
                                       -0.0000174046, &
                                        0.1159041300, &
                                        0.0398396589, &
                                        0.2996667325, &
                                        0.1194662079, &
                                        0.0303177871, &
                                        0.8542948365, &
                                       -0.2469638437, &
                                        0.0687641203, &
                                        0.7660933733, &
                                       -0.1354198158, &
                                       -0.2969137132, &
                                        0.1583693475, &
                                        0.2044430375, &
                                        0.1009043381, &
                                        0.3086345196, &
                                        1.2281339169, &
                                       -0.0534037054, &
                                        0.2123111486, &
                                        0.0827864856, &
                                        0.2223175615, &
                                       -0.4114154279, &
                                        0.2934573889, &
                                       -0.0252272468, &
                                        0.0074023576, &
                                       -0.2037528604, &
                                        0.0474943705, &
                                        1.0422163010, &
                                        0.2921275198, &
                                        0.6164401174, &
                                        0.6106783748, &
                                        0.1356533170, &
                                       -0.0000151394, &
                                       -0.1901205629, &
                                       -0.2649876773, &
                                        0.1940279901, &
                                        0.0740782842, &
                                        0.0468885824, &
                                        0.6101396680, &
                                        0.0372761972, &
                                       -0.0755983144, &
                                        0.6684833765, &
                                       -0.2253516614, &
                                        0.0009879954, &
                                        0.1578083485, &
                                        0.0985610858, &
                                       -0.0930514634, &
                                        0.1369333565, &
                                       -1.5101736784, &
                                       -0.1005292982, &
                                        0.3908382952, &
                                        0.2470025271, &
                                        0.0114832940, &
                                       -0.0000000000, &
                                        0.1688645035, &
                                       -0.1214455143, &
                                       -0.1926183552, &
                                       -1.0727015734, &
                                        0.1017204225, &
                                       -0.9851895571, &
                                       -0.0593089685, &
                                       -0.3661006987, &
                                        0.2689797878, &
                                       -0.4279471338, &
                                       -0.0000009621, &
                                        0.0847028345, &
                                        0.5090222359, &
                                        0.0208552219, &
                                        0.0092435768, &
                                        0.0182837546, &
                                       -0.4420877993, &
                                        0.2983163893, &
                                       -0.2504903376, &
                                       -0.4422901571, &
                                        0.0222428050, &
                                       -0.4008785486, &
                                        0.1741577387, &
                                       -0.0767076313, &
                                        0.0527319461, &
                                        0.0947921574], &
                                       [32, 32] )
            output_weights = reshape( [-0.1306072772, &
                                       -0.0881635025, &
                                       -0.0717933029, &
                                        0.4598636031, &
                                        0.0424535088, &
                                        0.1185232401, &
                                        0.0742791891, &
                                       -0.3229705095, &
                                       -0.0290467255, &
                                       -0.4960519075, &
                                        0.0202759746, &
                                       -0.0301414672, &
                                        0.3317853212, &
                                        0.1167574376, &
                                        0.1976169944, &
                                       -0.3296789825, &
                                        0.2258847356, &
                                        0.1397072524, &
                                        0.3722859621, &
                                       -0.7621382475, &
                                        0.0000000004, &
                                        0.2787525654, &
                                        0.2816138268, &
                                       -0.7409207225, &
                                       -0.0540639423, &
                                       -0.2465241402, &
                                       -0.0842243433, &
                                       -0.0129233021, &
                                        0.1009964943, &
                                        0.0495658368, &
                                       -0.2045328021, &
                                        0.6992035508, &
                                       -0.0985359550, &
                                       -0.4324615002, &
                                       -0.3896750510, &
                                        0.5007520914, &
                                       -0.2485446483, &
                                       -0.2464393377, &
                                        0.9053960443, &
                                       -0.2487722784, &
                                       -0.8380512595, &
                                        0.4266030490, &
                                        0.4685050845, &
                                        0.3570760787, &
                                       -0.2877221704, &
                                       -0.3562579453, &
                                       -0.3836098611, &
                                        0.4857460856, &
                                        0.3235684931, &
                                       -0.6166593432, &
                                        0.1503808349, &
                                       -0.9194840193, &
                                        0.0000001692, &
                                       -0.4799615443, &
                                        0.0966560915, &
                                       -0.2294768542, &
                                       -0.3964773118, &
                                       -0.2691475451, &
                                        0.3268204927, &
                                       -0.1158018261, &
                                        0.3435949683, &
                                        0.4372274280, &
                                        0.4000992179, &
                                       -0.5031387806], &
                                       [32, 2] )

            layer1_biases = [-0.0879830420, &
                             -0.5952099562, &
                              0.1108715087, &
                              0.4043408930, &
                              0.1911727935, &
                              0.5254348516, &
                             -0.1280797273, &
                              0.2318273187, &
                              0.3698801398, &
                             -0.0729610845, &
                              0.4177078009, &
                             -0.1288797110, &
                              0.2588399053, &
                              0.2189332843, &
                             -0.2445123345, &
                              0.4064738750, &
                              0.0633270741, &
                              0.1375025064, &
                              0.2293445319, &
                             -0.1083277687, &
                              0.3921291530, &
                              0.1784813255, &
                             -0.1926533729, &
                             -0.0944844261, &
                              0.2337695211, &
                             -0.0948756710, &
                              0.3624076247, &
                             -0.0729673281, &
                             -0.0169583857, &
                             -0.1137377471, &
                              0.5684820414, &
                              0.3200140595]
            layer2_biases = [-0.0235288944, &
                              0.0509605743, &
                              0.0174061842, &
                              0.1791113019, &
                              0.2929983139, &
                             -0.1698583364, &
                              0.1001327038, &
                              0.1145873144, &
                              0.2135642022, &
                              0.0435810573, &
                              0.0922324881, &
                              0.0185730029, &
                              0.0181283671, &
                             -0.0240316447, &
                             -0.1123080626, &
                              0.1679151207, &
                             -0.0000653851, &
                              0.2229463160, &
                             -0.1743082702, &
                              0.2192904651, &
                              0.2398125976, &
                              0.1765519232, &
                              0.0451031625, &
                              0.2310215384, &
                              0.1354273409, &
                             -0.1729580611, &
                              0.0226894245, &
                             -0.1776903570, &
                              0.1911435127, &
                              0.0945761204, &
                              0.0280319657, &
                              0.0503484048]
            layer3_biases = [-0.0129000759, &
                              0.0776343644, &
                              0.1040842608, &
                             -0.0903618932, &
                              0.0330945142, &
                              0.1668473333, &
                             -0.0457190834, &
                              0.0664545149, &
                             -0.2340384722, &
                              0.0504303947, &
                             -0.0076428927, &
                              0.0710352510, &
                              0.0709152594, &
                              0.1417934895, &
                             -0.0004222295, &
                              0.1598898768, &
                              0.1044366062, &
                              0.1171673089, &
                              0.0558530204, &
                             -0.1378494054, &
                             -0.0000000000, &
                              0.0470191501, &
                              0.0609676726, &
                              0.0004412594, &
                             -0.0796624050, &
                              0.1558942795, &
                              0.2366052270, &
                             -0.0374331661, &
                              0.0090837320, &
                              0.0383411273, &
                              0.1808212698, &
                             -0.0802949816]
            output_biases = [ 0.0461170152, &
                              0.1239732876]

        end subroutine initialize_model

        ! Estimates a droplet's future size and temperature based on it's current size
        ! and temperature, as well as key parameters from the environment its in.
        ! Inputs and outputs are provided/returned in un-normalized physical scales.
        subroutine estimate( input, output )

            implicit none

            !
            ! NOTE: This is hardcoded to assume a batch size of 1 so we can have
            !       a 1D array vs dealing with a 2D array with a singleton
            !       dimension.
            !
            real*4, dimension(NUMBER_INPUTS), intent(in)   :: input
            real*4, dimension(NUMBER_OUTPUTS), intent(out) :: output

            real*4, dimension(NUMBER_INPUTS)               :: normalized_input
            integer                                        :: output_index

            ! Normalize the non-temporal inputs so they're in the range [-1, 1].
            normalized_input(RADIUS_INDEX)          = (log10( input(RADIUS_INDEX) ) - RADIUS_LOG_MEAN) / RADIUS_LOG_WIDTH
            normalized_input(TEMPERATURE_INDEX)     = (input(TEMPERATURE_INDEX) - TEMPERATURE_MEAN) / TEMPERATURE_WIDTH
            normalized_input(SALINITY_INDEX)        = (log10( input(SALINITY_INDEX) ) - SALINITY_LOG_MEAN) / SALINITY_LOG_WIDTH
            normalized_input(AIR_TEMPERATURE_INDEX) = (input(AIR_TEMPERATURE_INDEX) - AIR_TEMPERATURE_MEAN) / AIR_TEMPERATURE_WIDTH
            normalized_input(RH_INDEX)              = (input(RH_INDEX) - RH_MEAN) / RH_WIDTH
            normalized_input(RHOA_INDEX)            = (input(RHOA_INDEX) - RHOA_MEAN) / RHOA_WIDTH

            ! Our integration time remains as is.
            normalized_input(TFINAL_INDEX)          = input(TFINAL_INDEX)

            ! Compute x_1 = ReLU( W_1*I + b_1 ).
            do output_index = 1, NUMBER_HIDDEN_LAYER1_NEURONS
                layer1_intermediate(output_index) = &
                     max( sum( normalized_input(:) * layer1_weights(:, output_index) ) + layer1_biases(output_index), 0.0 )
            end do

            ! Compute x_2 = ReLU( W_2*x_1 + b_2 ).
            do output_index = 1, NUMBER_HIDDEN_LAYER2_NEURONS
                layer2_intermediate(output_index) = &
                     max( sum( layer1_intermediate(:) * layer2_weights(:, output_index) ) + layer2_biases(output_index), 0.0 )
            end do

            ! Compute x_3 = ReLU( W_3*x_2 + b_3 ).
            do output_index = 1, NUMBER_HIDDEN_LAYER3_NEURONS
                layer3_intermediate(output_index) = &
                     max( sum( layer2_intermediate(:) * layer3_weights(:, output_index) ) + layer3_biases(output_index), 0.0 )
            end do

            ! Compute O = W_4*x_3 + b_4.
            do output_index = 1, NUMBER_OUTPUTS
                output(output_index) = sum( layer3_intermediate(:) * output_weights(:, output_index) ) + output_biases(output_index)
            end do

            ! Scale the outputs to the expected ranges.
            output(RADIUS_INDEX)      = 10.0**(output(RADIUS_INDEX) * RADIUS_LOG_WIDTH + RADIUS_LOG_MEAN)
            output(TEMPERATURE_INDEX) = output(TEMPERATURE_INDEX) * TEMPERATURE_WIDTH + TEMPERATURE_MEAN

        end subroutine estimate

end module droplet_model
